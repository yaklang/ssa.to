<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-syntaxflow-guide docs-version-current docs-doc-page docs-doc-id-nativecall-demos" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">常见 NativeCall 以及用例 | SSA.to</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ssa.to/en/syntaxflow-guide/nativecall-demos"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" property="og:title" content="常见 NativeCall 以及用例 | SSA.to"><meta data-rh="true" name="description" content="在 SyntaxFlow 中，NativeCall 是一种强大的机制，允许用户在规则中调用内置函数来实现复杂的分析功能。本章节将详细介绍一些常用的 NativeCall 及其实际应用场景。"><meta data-rh="true" property="og:description" content="在 SyntaxFlow 中，NativeCall 是一种强大的机制，允许用户在规则中调用内置函数来实现复杂的分析功能。本章节将详细介绍一些常用的 NativeCall 及其实际应用场景。"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ssa.to/en/syntaxflow-guide/nativecall-demos"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/nativecall-demos" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ssa.to/en/syntaxflow-guide/nativecall-demos" hreflang="en"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/nativecall-demos" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.e4c0332c.css">
<script src="/en/assets/js/runtime~main.869e169b.js" defer="defer"></script>
<script src="/en/assets/js/main.17a78c5f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo-dark.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SSA.to</b></a><a class="navbar__item navbar__link" href="/en/static-analysis-guide/intro">静态代码分析教程</a><a class="navbar__item navbar__link" href="/en/docs/intro">代码扫描基础使用</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/syntaxflow-guide/intro">SyntaxFlow 文档</a><a class="navbar__item navbar__link" href="/en/cookbook">SyntaxFlow 手册离线 PDF</a><a class="navbar__item navbar__link" href="/en/codeAnalysis">Code Analysis NOW!</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/syntaxflow-guide/nativecall-demos" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">中文</a></li><li><a href="/en/syntaxflow-guide/nativecall-demos" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbarSearchContainer_dCNk"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/intro">SyntaxFlow 简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/quick-start">SyntaxFlow 快速入门指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/rule-intro">SyntaxFlow 规则文件介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/en/syntaxflow-guide/rule-intro">编写基础的 SyntaxFlow 规则</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/rule-intro">SytanxFlow 规则介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/intro-and-desc">1. desc 语句：准备并编写基础描述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-search">2. 搜索定位：搜索符号或方法名</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-func-call">3. 函数调用：审计调用和参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-variable">4. 变量：存储和追踪审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dot-call-chain">5. 链式调用：递归检查成员和调用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dataflow">6. 数据流运算：追踪定义和使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-filter">7. 过滤器：?{...} 筛选审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-calc">8. 集合运算：交集 &amp;，差集 -，并集 +</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-nativecall">9. 原生扩展：重要的 NativeCall 机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-sca">10. SCA: 依赖版本信息检测</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf_file_filter">11. 文件过滤：检测文件内容</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/syntaxflow-guide/nativecall-demos">常见 NativeCall 以及用例</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow">高级静态代码分析实战</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow">数据流敏感的代码漏洞检测</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">常见 NativeCall 以及用例</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>常见 NativeCall 以及用例</h1></header>
<p>在 SyntaxFlow 中，NativeCall 是一种强大的机制，允许用户在规则中调用内置函数来实现复杂的分析功能。本章节将详细介绍一些常用的 NativeCall 及其实际应用场景。</p>
<!-- -->
<div class="tableOfContentsInline_prmo"><ul class="table-of-contents"><li><a href="#什么是-nativecall">什么是 NativeCall？</a></li><li><a href="#常用-nativecall-详解">常用 NativeCall 详解</a><ul><li><a href="#include">include</a></li><li><a href="#typename">typeName</a></li><li><a href="#fulltypename">fullTypeName</a></li><li><a href="#getreturns">getReturns</a></li><li><a href="#getformalparams">getFormalParams</a></li><li><a href="#getfunc">getFunc</a></li><li><a href="#getcall">getCall</a></li><li><a href="#getcallee">getCallee</a></li><li><a href="#searchfunc">searchFunc</a></li><li><a href="#getobject">getObject</a></li><li><a href="#getmembers">getMembers</a></li><li><a href="#getmemberbykey">getMemberByKey</a></li><li><a href="#getsiblings">getSiblings</a></li><li><a href="#name">name</a></li><li><a href="#string">string</a></li><li><a href="#eval">eval</a></li><li><a href="#fuzztag">fuzztag</a></li><li><a href="#show">show</a></li><li><a href="#slice">slice</a></li><li><a href="#regexp">regexp</a></li><li><a href="#strlower">strlower</a></li><li><a href="#strupper">strupper</a></li><li><a href="#var">var</a></li><li><a href="#opcodes">opcodes</a></li><li><a href="#sourcecode">sourceCode</a></li><li><a href="#scannext">scanNext</a></li><li><a href="#scanprevious">scanPrevious</a></li><li><a href="#scaninstruction">scanInstruction</a></li><li><a href="#const">const</a></li><li><a href="#versionin">versionIn</a></li><li><a href="#dataflow">dataflow</a></li><li><a href="#self">self</a></li><li><a href="#forbid">forbid</a></li><li><a href="#delete">delete</a></li><li><a href="#getusers">getUsers</a></li><li><a href="#getpredecessors">getPredecessors</a></li><li><a href="#getactualparams">getActualParams</a></li><li><a href="#getactualparamlen">getActualParamLen</a></li><li><a href="#getcurrentblueprint">getCurrentBlueprint</a></li><li><a href="#getblueprint">getBluePrint</a></li><li><a href="#getparentsblueprint">getParentsBlueprint</a></li><li><a href="#getinterfaceblueprint">getInterfaceBlueprint</a></li><li><a href="#getrootparentblueprint">getRootParentBlueprint</a></li><li><a href="#extendsby">extendsBy</a></li><li><a href="#len">len</a></li><li><a href="#root">root</a></li><li><a href="#filenamebycontent">FilenameByContent</a></li><li><a href="#getfullfilename">getFullFileName</a></li><li><a href="#foreach_function_inst">foreach_function_inst</a></li><li><a href="#javaunescapeoutput">javaUnescapeOutput</a></li><li><a href="#issanitizename">isSanitizeName</a></li><li><a href="#mybatissink">mybatisSink</a></li></ul></li><li><a href="#总结">总结</a></li></ul></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是-nativecall">什么是 NativeCall？<a href="#什么是-nativecall" class="hash-link" aria-label="Direct link to 什么是 NativeCall？" title="Direct link to 什么是 NativeCall？">​</a></h2>
<p>NativeCall 是 SyntaxFlow 提供的一种特殊机制，它允许用户在规则中直接调用一些内置的高级分析函数。这些函数通常封装了复杂的分析逻辑，使得用户可以更方便地实现高级分析功能，而无需手动编写复杂的逻辑。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>为什么需要 NativeCall？</div><div class="admonitionContent_BuS1"><ul>
<li>简化复杂分析逻辑的实现</li>
<li>提供标准化的分析接口</li>
<li>提高规则的可维护性</li>
<li>确保分析的一致性和准确性</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常用-nativecall-详解">常用 NativeCall 详解<a href="#常用-nativecall-详解" class="hash-link" aria-label="Direct link to 常用 NativeCall 详解" title="Direct link to 常用 NativeCall 详解">​</a></h2>
<p>SyntaxFlow 提供了丰富的 NativeCall 功能，极大地扩展了规则编写的灵活性。在使用 IRify 编写规则时，输入 <code>&lt;</code> 符号会自动提示可用的 NativeCall，无需记忆具体的函数名称。</p>
<p><img decoding="async" loading="lazy" alt="NativeCall 示例图" src="/en/assets/images/nativecall-demos1-dfe3cafa6209118be88f0e912951ac9c.png" width="745" height="506" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="include">include<a href="#include" class="hash-link" aria-label="Direct link to include" title="Direct link to include">​</a></h3>
<p>include 是一个高频使用的 NativeCall，它允许在本规则中引用其他的规则，实现规则的复用与解耦。</p>
<p>比如，在编写 SpringBoot 的数据流分析规则时，通常会遇到用户可控输入点（Source）都是控制层的可控参数，而污染汇聚点（Sink）则是不固定的。为了复用 Source 的规则，我们可以将其单独写成一个规则，并在 <code>desc</code> 声明的时候添加 <code>lib</code> 字段，以便被其他规则调用。</p>
<p>以下为内置规则中，查找 Java Spring Boot 的用户可控输入的规则:</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">desc(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title: &#x27;checking [spring controller source parameter]&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: audit,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lib: &#x27;java-spring-param&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    desc: &lt;&lt;&lt;TEXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">此规则旨在审计Spring框架中控制器方法的参数来源安全性。确保控制器方法中的参数来源清晰且安全至关重要，因为不当的参数处理可能导致安全漏洞，如SQL注入、跨站脚本攻击(XSS)等。通过检查控制器方法的参数是否明确指定了来源（如通过@RequestParam、@PathVariable等注解），可以防止潜在的参数篡改和注入攻击。此外，这也有助于维护代码的清晰性和可维护性。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*Mapping.__ref__?{opcode: function} as $start;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// annotation method&#x27; formal params.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$start(*?{opcode: param &amp;&amp; !have: this} as $formalParams);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// fetching getParameter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.getParameter()?{&lt;getFunc&gt;.annotation.*Mapping} as $dynamicParams;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// merge start and output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$formalParams + $dynamicParams as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// output lib params</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $output;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>desc</code> 中声明的 <code>lib</code> 为 <code>java-spring-param</code>，其他规则要调用这个规则就使用这个名称。在规则的最后使用 <code>alert $output</code>，将该规则分析的值传出。</p>
<p>在其他规则中，就可以使用 NativeCall 调用该 lib 规则了:</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-spring-param&#x27;)&gt; as $source;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这样，我们就能够根据不同的情况组合各种 lib 规则，比如检测 Java Spring Boot SSRF 漏洞的规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">desc(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title_zh: &quot;检测Java SpringBoot 直接SSRF&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title: &quot;Find Java SpringBoot SSRF Vuln&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: vuln,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-spring-param&#x27;)&gt; as $source;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&quot;java-http-sink&quot;)&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink #{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    include: `&lt;self&gt; &amp; $source`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exclude: `&lt;self&gt;?{opcode:call}?{!&lt;self&gt; &amp; $source}?{!&lt;self&gt; &amp; $sink}`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}-&gt;as $mid;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $mid for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    message: &quot;发现Java SpringBoot SSRF漏洞，且未进行数据流过滤。&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    risk: ssrf,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    level: mid,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>比如 Java Spring Boot 与 Java Servlet 检测 RCE 的规则:</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">desc(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title: &quot;Servlet &amp; Springframework Paremeter Passed into Command Injection Sink&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    title: &#x27;Servlet &amp; Springframework 基础参数命令注入&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type: vuln,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    risk: rce,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    desc: &lt;&lt;&lt;TEXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    在Java中，如果用户输入的参数直接传递给命令执行函数，可能会导致命令注入漏洞。攻击者可以通过构造恶意输入，执行系统命令，进而控制服务器。为了防止命令注入漏洞，需要对用户输入的参数进行严格的过滤，包括验证参数的合法性、长度、字符等，并尽量避免直接将用户输入的参数传递给命令执行函数。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-servlet-param&#x27;)&gt; as $source;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-spring-param&#x27;)&gt; as $source;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check $source;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-runtime-exec-sink&#x27;)&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;include(&#x27;java-command-exec-sink&#x27;)&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink #{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    include: `&lt;self&gt; &amp; $source`,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    exclude: `&lt;self&gt;?{opcode:call}?{!&lt;self&gt; &amp; $source}`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}-&gt;as $high;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $high for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    message: &quot;发现Java代码中存在命令注入漏洞，且未进行数据流过滤。&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    level: high,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="typename">typeName<a href="#typename" class="hash-link" aria-label="Direct link to typeName" title="Direct link to typeName">​</a></h3>
<p><code>typeName</code> 用于获取一个值的类型名。默认情况下，<code>typeName</code> 包含该值所属类的简单名称以及全名称。类型名是通过所导入包进行生成的，如以下例子:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.example.moudels.typename;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">import com.alibaba.fastjson.JSON;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.swagger.annotations.ApiParam;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.http.ResponseEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Controller;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestParam;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.client.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Api(value = &quot;TypeNameController&quot;, tags = &quot;Irify TypeName用例&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RequestMapping(&quot;/typename&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TypeNameController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/simple&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ResponseEntity&lt;Object&gt; simple(@RequestParam(name = &quot;id&quot;) String id) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object anyJSON = JSON.parse(id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return ResponseEntity.ok(anyJSON);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>JSON.parse</code> 的 <code>typeName</code> 是根据 import 了 <code>com.alibaba.fastjson.JSON</code> 的包所确定的。这个导入的包名同时也是 <code>JSON.parse</code> 的全限定名称。以下是获取 <code>typeName</code> 的规则:</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">JSON.parse&lt;typeName()&gt; as $name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="JSON.parse typeName 示例图" src="/en/assets/images/nativecall-demos2-3ed05f5165dda6e23fcdf29b800a11d5.png" width="1219" height="586" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="import-all-机制">Import all 机制<a href="#import-all-机制" class="hash-link" aria-label="Direct link to Import all 机制" title="Direct link to Import all 机制">​</a></h4>
<p>一些情况下，有一些类的使用是通过 import all 实现的，比如以下例子：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package org.example.moudels.typename;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.alibaba.fastjson.JSON;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.swagger.annotations.Api;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.swagger.annotations.ApiParam;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.http.ResponseEntity;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.stereotype.Controller;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.web.bind.annotation.RequestParam;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">import org.springframework.web.client.*;</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">import org.springframework.web.cors.*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Api(value = &quot;TypeNameController&quot;, tags = &quot;Irify TypeName用例&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@RequestMapping(&quot;/typename&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class TypeNameController {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @GetMapping(&quot;/importAll&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void importAll(@ApiParam(name=&quot;url&quot;,value=&quot;请求参数&quot;,required = true)@RequestParam String url) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CorsConfiguration corsConfiguration = new CorsConfiguration();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        corsConfiguration.addAllowedOrigin(url);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其中 <code>CorsConfiguration</code> 在源码中是根据 <code>import org.springframework.web.cors.*;</code> 导入的，该导入语句称作 import all 语句。import all 语句使得 <code>CorsConfiguration</code> 无法确定可以使用哪个语句进行生成 <code>typeName</code>。因此没办法确定使用哪条 import 语句生成 <code>typeName</code> 的值，会使用以下方式生成 <code>typeName</code>，以确保不会遗漏任何分析信息：</p>
<ol>
<li>将自身名称与当前的包名拼接</li>
<li>将自身名称与所有 import all 语句拼接</li>
<li>与默认导入的 <code>java.lang</code> 包进行拼接</li>
</ol>
<p>因此 <code>CorsConfiguration</code> 有 5 个 <code>typeName</code>:</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CorsConfiguration()&lt;typeName()&gt; as $name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="import all typeName 示例图" src="/en/assets/images/nativecall-demos3-4678f4376bd1a9f7a1f548c175095ee0.png" width="1390" height="317" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="左右类型合并">左右类型合并<a href="#左右类型合并" class="hash-link" aria-label="Direct link to 左右类型合并" title="Direct link to 左右类型合并">​</a></h4>
<p>在语句 <code>Object anyJSON = JSON.parse(id);</code> 中，右值 <code>JSON.parse</code> 的 <code>typeName</code> 是确定的，左值的 <code>anyJson</code> 的类型是 <code>Object</code>，而 <code>Object</code> 又没有进行显式导入，因而会通过 import all 机制生成 <code>typeName</code>。同时左右值的 <code>typeName</code> 不一致，因而会将左右值的 <code>typeName</code> 进行合并，以确保不会遗漏分析信息：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">anyJSON&lt;typeName()&gt; as $name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="左右类型合并 typeName 示例图" src="/en/assets/images/nativecall-demos4-6a600214cef466fc1779aa9874b5fd37.png" width="1492" height="587" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fulltypename">fullTypeName<a href="#fulltypename" class="hash-link" aria-label="Direct link to fullTypeName" title="Direct link to fullTypeName">​</a></h3>
<p><code>fullTypeName</code> 意为全限定名，即一个值类型的全名称。它本质上与 <code>typeName</code> 一样，不过少了简单名称，并且多了版本信息（如果导入的类有版本信息的话）。如下：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">JSON.parse&lt;fullTypeName()&gt; as $name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="fullTypeName 示例图" src="/en/assets/images/nativecall-demos5-6e7cfcfdfd16009db03a50727a60d0df.png" width="1406" height="529" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getreturns">getReturns<a href="#getreturns" class="hash-link" aria-label="Direct link to getReturns" title="Direct link to getReturns">​</a></h3>
<p><code>getReturns</code> 用于获取函数的返回值。输入必须是一个函数指令。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理">实现原理<a href="#实现原理" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>getReturns</code> 的工作流程如下：</p>
<!-- -->
<p>这个过程确保了数据流分析的完整性，使得可以追踪从函数返回值到其使用点的完整路径。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例">示例<a href="#示例" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String HHHHH(@RequestParam(value = &quot;xxx&quot;) String xxxFooBar) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;Hello getReturns&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HHHHH &lt;getReturns&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果: &quot;Hello getReturns&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>实际规则用法 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Controller.__ref__&lt;getMembers&gt;?{.annotation.*Mapping &amp;&amp; !.annotation.ResponseBody} as $entryMethods;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$entryMethods&lt;getReturns&gt;?{&lt;typeName&gt;?{have: String}}?{have:&#x27;redirect:&#x27;} as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则用于检测Java URL重定向漏洞，它：</p>
<ol>
<li>找到所有 Controller 类的成员方法</li>
<li>过滤出有 Mapping 注解但没有 ResponseBody 注解的方法</li>
<li>获取这些方法的返回值</li>
<li>筛选出类型为 String 且包含 &#x27;redirect:&#x27; 的返回值</li>
</ol>
<p><strong>FreeMarker 模板注入检测 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*Mapping.__ref__&lt;getFunc&gt;&lt;getReturns&gt;?{&lt;typeName&gt;?{have:&#x27;String&#x27;}}&lt;freeMarkerSink&gt; as $a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>找到有 Mapping 注解的方法</li>
<li>获取包含这些方法的函数</li>
<li>获取函数的返回值</li>
<li>筛选出 String 类型的返回值</li>
<li>应用 FreeMarker sink 检测</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getformalparams">getFormalParams<a href="#getformalparams" class="hash-link" aria-label="Direct link to getFormalParams" title="Direct link to getFormalParams">​</a></h3>
<p><code>getFormalParams</code> 用于获取函数的形参。输入必须是一个函数指令。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理-1">实现原理<a href="#实现原理-1" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>getFormalParams</code> 的工作流程如下：</p>
<ol>
<li><strong>输入验证</strong>: 接收函数值作为输入，递归遍历处理</li>
<li><strong>操作码检查</strong>: 验证输入值的操作码是否为Function类型</li>
<li><strong>函数转换</strong>: 将输入值转换为函数对象，获取函数的元数据</li>
<li><strong>参数列表获取</strong>: 从函数定义中提取形式参数列表</li>
<li><strong>参数值创建</strong>: 为每个形式参数创建对应的Value对象</li>
<li><strong>关系建立</strong>: 建立参数值与原函数之间的前驱关系，用于数据流追踪</li>
<li><strong>结果返回</strong>: 返回包含所有形式参数的值集合</li>
</ol>
<p>这个机制使得可以从函数定义出发，找到所有可能的输入点，这对于安全分析中的污点源识别非常重要。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-1">示例<a href="#示例-1" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String HHHHH(@RequestParam(value = &quot;xxx&quot;) String xxxFooBar) throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &quot;Hello getReturns&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">HHHHH &lt;getFormalParams&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果: [&quot;xxxFooBar&quot;, &quot;this&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Spring Controller 参数提取 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$start&lt;getFormalParams&gt;?{opcode: param &amp;&amp; !have: this} as $params;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则用于获取 Spring MVC 控制器方法的所有非 this 参数，用于识别用户输入源。</p>
<p><strong>Java Servlet 参数提取 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/(do(Get|Post|Delete|Filter|[A-Z]\w+))|(service)/&lt;getFormalParams&gt;?{!have: this &amp;&amp; opcode: param } as $req;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>匹配 Servlet 的 doGet、doPost 等方法</li>
<li>获取这些方法的形参</li>
<li>过滤掉 this 参数，只保留方法参数</li>
</ol>
<p><strong>注解测试用法 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*Mapping.__ref__&lt;getFormalParams&gt;?{opcode: param &amp;&amp; !have: this} as $ref</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个测试：</p>
<ol>
<li>找到有 Mapping 注解的方法</li>
<li>获取方法的形参</li>
<li>筛选出非 this 的参数</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getfunc">getFunc<a href="#getfunc" class="hash-link" aria-label="Direct link to getFunc" title="Direct link to getFunc">​</a></h3>
<p><code>getFunc</code> 用于获取输入指令所在的函数。输入可以是任何指令。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理-2">实现原理<a href="#实现原理-2" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>getFunc</code> 的工作流程如下：</p>
<ol>
<li><strong>值遍历</strong>: 递归处理输入的所有值</li>
<li><strong>函数查找</strong>: 对于每个值，向上查找包含该值的函数上下文</li>
<li><strong>函数提取</strong>: 从SSA的函数结构中提取函数定义</li>
<li><strong>对象创建</strong>: 为找到的函数创建新的Value对象</li>
<li><strong>关系建立</strong>: 建立与原始值的前驱关系</li>
<li><strong>结果聚合</strong>: 返回所有找到的函数值集合</li>
</ol>
<p>这个NativeCall特别有用于上下文分析，可以帮助确定某个值或操作发生在哪个  函数范围内。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="项目中的真实用法">项目中的真实用法<a href="#项目中的真实用法" class="hash-link" aria-label="Direct link to 项目中的真实用法" title="Direct link to 项目中的真实用法">​</a></h4>
<p><strong>获取特定类型的控制器函数 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$sink?{&lt;getFunc&gt;&lt;getCurrentBlueprint&gt;&lt;fullTypeName&gt;?{any: &quot;Controller&quot;,&quot;controller&quot;}} as $output</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>获取sink值所在的函数</li>
<li>获取该函数的当前类蓝图</li>
<li>检查类的全限定名是否包含&quot;Controller&quot;</li>
<li>用于识别ThinkPHP控制器方法</li>
</ol>
<p><strong>Spring Boot文件下载漏洞检测 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$params?{&lt;getFunc&gt;&lt;getReturns&gt;&lt;typeName&gt;?{have: ResponseEntity}&lt;show&gt;} as $entry;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>从参数出发获取所在函数</li>
<li>获取函数的返回值</li>
<li>检查返回值类型是否为ResponseEntity</li>
<li>用于识别文件下载相关的处理函数</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getcall">getCall<a href="#getcall" class="hash-link" aria-label="Direct link to getCall" title="Direct link to getCall">​</a></h3>
<p><code>getCall</code> 用于获取输入指令的调用指令。输入必须是一个函数指令。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理-3">实现原理<a href="#实现原理-3" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>getCall</code> 的工作机制：</p>
<ol>
<li><strong>输入处理</strong>: 遍历输入的所有值</li>
<li><strong>使用者查找</strong>: 查找每个值的使用者（Users）</li>
<li><strong>调用过滤</strong>: 筛选出操作码为Call类型的使用者</li>
<li><strong>调用收集</strong>: 收集所有符合条件的调用指令</li>
<li><strong>关系建立</strong>: 为每个调用建立与原 值的前驱关系</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-2">示例<a href="#示例-2" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>测试用例 :</strong></p>
<p><strong>链式调用分析 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$concatA&lt;getCall&gt;&lt;getCallee&gt;(,* as $b) as $concatB;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$concatB&lt;getCall&gt;&lt;getCallee&gt;(,* as $c);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个测试展示了如何通过getCall追踪链式方法调用。</p>
<p><strong>Golang数据库连接追踪 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$entry.Open &lt;getCall&gt; as $db;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>找到数据库库的Open方法</li>
<li>获取对Open方法的调用</li>
<li>将调用结果标记为数据库连接对象</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getcallee">getCallee<a href="#getcallee" class="hash-link" aria-label="Direct link to getCallee" title="Direct link to getCallee">​</a></h3>
<p><code>getCallee</code> 用于获取调用指令中被调用的函数。输入必须是一个调用指令(call)。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理-4">实现原理<a href="#实现原理-4" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>getCallee</code> 的处理流程：</p>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-3">示例<a href="#示例-3" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>函数名提取 :</strong></p>
<p><strong>SQL注入检测 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$params&lt;getCallee&gt;?{&lt;name&gt;?{have:toString}}&lt;getObject&gt;.append(,* as $appendParams)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则：</p>
<ol>
<li>从参数获取被调用的函数</li>
<li>检查函数名是否包含toString</li>
<li>获取调用对象并查找append方法</li>
<li>用于检测SQL注入中的字符串拼接模式</li>
</ol>
<p><strong>XSS过滤检测 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$calls?{&lt;getCallee&gt;&lt;name&gt;?{have: /(?i)(sanitiz|encod(e|ing)|entit(y|ies)|escap(e|ing)|replace|regex|normaliz|canonical|anti|safe|purif|purg|pure|validate|strip|clean|clear|special|convert|remov)/}} as $__next</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个规则通过getCallee获取被调用函数，然后检查函数名是否匹配常见的过滤/编码函数模式。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="searchfunc">searchFunc<a href="#searchfunc" class="hash-link" aria-label="Direct link to searchFunc" title="Direct link to searchFunc">​</a></h3>
<p><code>searchFunc</code> 用于搜索输入指令的调用指令。它是一个强大的函数搜索机制，可以处理多种不同类型的输入并找到相关的函数调用。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="实现原理-5">实现原理<a href="#实现原理-5" class="hash-link" aria-label="Direct link to 实现原理" title="Direct link to 实现原理">​</a></h4>
<p><code>searchFunc</code> 的工作机制比较复杂，它能够处理多种不同的输入类型：</p>
<!-- -->
<p>主要处理的情况包括：</p>
<ol>
<li><strong>参数成员</strong>: 从参数成员获取函数名进行搜索</li>
<li><strong>普通参数</strong>: 从参数所属函数获取方法名进行搜索</li>
<li><strong>调用指令</strong>: 提取被调用函数名，去除对象前缀后搜索</li>
<li><strong>常量指令</strong>: 解析常量字符串作为函数名搜索</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-4">示例<a href="#示例-4" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>数据流追踪示例:</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 从变量出发，找到调用它的地方，再搜索同名函数的其他调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aArgs &lt;getCall&gt; &lt;searchFunc&gt; as $allCalls;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这个NativeCall特别适用于：</p>
<ul>
<li>查找函数的所有调用点</li>
<li>进行跨函数的数据流分析</li>
<li>识别相同函数名的不同实现</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getobject">getObject<a href="#getobject" class="hash-link" aria-label="Direct link to getObject" title="Direct link to getObject">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用">作用<a href="#作用" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的父对象。如果指令是一个成员，可以通过这个指令获取成员的父对象。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-5">示例<a href="#示例-5" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本对象成员访问</strong></p>
<p>测试代码：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">&quot;b&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&quot;c&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">222</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&quot;e&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">333</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.b&lt;getObject&gt;.c as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.b</code> - 获取对象a的成员b</li>
<li><code>&lt;getObject&gt;</code> - 获取成员b的父对象，即对象a</li>
<li><code>.c</code> - 访问父对象的成员c</li>
<li>结果为 222，通过父对象间接访问其他成员</li>
</ul>
<p><strong>2. Spring MVC参数检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.getParameter()?{&lt;getCallee&gt;&lt;getObject&gt;&lt;fullTypeName&gt;?{have: servlet} &amp;&amp; &lt;getFunc&gt;&lt;getObject&gt;.annotation.*Mapping} as $dynamicParams</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.getParameter()</code> - 获取参数方法</li>
<li><code>&lt;getCallee&gt;&lt;getObject&gt;</code> - 获取方法调用的父对象</li>
<li><code>&lt;fullTypeName&gt;?{have: servlet}</code> - 检查父对象类型是否为Servlet</li>
<li><code>&lt;getFunc&gt;&lt;getObject&gt;.annotation.*Mapping</code> - 检查方法所在类是否有Mapping注解</li>
<li>用于识别Spring MVC控制器中的动态参数获取</li>
</ul>
<p><strong>3. 反序列化安全检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.readObject?{&lt;typeName&gt;?{have:&#x27;java.beans.XMLDecoder&#x27;}}&lt;getObject()&gt; as $decoder;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.readObject</code> - XML反序列化方法</li>
<li><code>&lt;typeName&gt;?{have:&#x27;java.beans.XMLDecoder&#x27;}</code> - 确认是XMLDecoder类型</li>
<li><code>&lt;getObject()&gt;</code> - 获取readObject方法的调用对象</li>
<li>用于检测XML反序列化漏洞</li>
</ul>
<p><strong>4. SQL注入检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$params&lt;getCallee&gt;?{&lt;name&gt;?{have:toString}}&lt;getObject&gt;.append(,* as $appendParams)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$params&lt;getCallee&gt;</code> - 获取被调用的方法</li>
<li><code>?{&lt;name&gt;?{have:toString}}</code> - 检查方法名包含toString</li>
<li><code>&lt;getObject&gt;</code> - 获取toString方法的调用对象</li>
<li><code>.append</code> - 查找对象的append方法</li>
<li>用于检测通过toString()后进行字符串拼接的SQL注入模式</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getmembers">getMembers<a href="#getmembers" class="hash-link" aria-label="Direct link to getMembers" title="Direct link to getMembers">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-1">作用<a href="#作用-1" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的成员指令。如果指令是一个对象，可以通过这个指令获取对象的所有成员。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-6">示例<a href="#示例-6" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. Spring Controller方法获取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Controller.__ref__&lt;getMembers&gt;?{.annotation.*Mapping &amp;&amp; !.annotation.ResponseBody} as $entryMethods;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>Controller.__ref__</code> - 获取Controller类的引用</li>
<li><code>&lt;getMembers&gt;</code> - 获取Controller类的所有成员方法</li>
<li><code>?{.annotation.*Mapping}</code> - 筛选有Mapping注解的方法</li>
<li><code>?{!.annotation.ResponseBody}</code> - 排除有ResponseBody注解的方法</li>
<li>用于识别Spring MVC控制器的视图返回方法</li>
</ul>
<p><strong>2. 数据库连接对象分析</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$db &lt;getMembers&gt; as $output;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$db</code> - 数据库连接对象</li>
<li><code>&lt;getMembers&gt;</code> - 获取数据库对象的所有可用方法和字段</li>
<li>结果包含Execute、Query、Prepare等数据库操作方法</li>
<li>用于数据库操作的安全分析</li>
</ul>
<p><strong>3. REST Controller API检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">RestController.__ref__&lt;getMembers&gt;?{.annotation.*Mapping} as $entryMethods;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>RestController.__ref__</code> - 获取RestController类引用</li>
<li><code>&lt;getMembers&gt;</code> - 获取类的所有成员方法</li>
<li><code>?{.annotation.*Mapping}</code> - 筛选有HTTP请求映射注解的方法</li>
<li>用于识别REST API端点方法</li>
</ul>
<p><strong>4. Golang数据库连接分析</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$entry.Open() &lt;getMembers&gt; as $client;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$entry.Open()</code> - 数据库连接打开操作</li>
<li><code>&lt;getMembers&gt;</code> - 获取连接对象的所有可用方法</li>
<li>用于分析数据库ORM框架的操作方法</li>
<li>常见于Golang的数据库操作分析</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getmemberbykey">getMemberByKey<a href="#getmemberbykey" class="hash-link" aria-label="Direct link to getMemberByKey" title="Direct link to getMemberByKey">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-2">作用<a href="#作用-2" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的特定成员。如果指令是一个对象，可以通过指定的key获取对象的某个特定成员。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-7">示例<a href="#示例-7" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. JSON敏感信息提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$sink&lt;getMemberByKey(key=&quot;password&quot;)&gt; as $obj</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$sink</code> - 目标对象（通常是JSON或数据结构）</li>
<li><code>&lt;getMemberByKey(key=&quot;password&quot;)&gt;</code> - 获取名为&quot;password&quot;的成员</li>
<li>用于检测JSON响应中的敏感信息泄露</li>
<li>常用于信息泄露漏洞检测</li>
</ul>
<p><strong>2. 配置对象特定字段提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config&lt;getMemberByKey(key=&quot;database_password&quot;)&gt; as $dbPassword;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config&lt;getMemberByKey(key=&quot;api_key&quot;)&gt; as $apiKey;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">config&lt;getMemberByKey(key=&quot;secret_token&quot;)&gt; as $token;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>从配置对象中提取特定的敏感配置项</li>
<li>用于检测硬编码密码和API密钥</li>
<li>帮助识别配置安全问题</li>
</ul>
<p><strong>3. 用户对象敏感字段访问</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">userObject&lt;getMemberByKey(key=&quot;creditCard&quot;)&gt; as $sensitiveData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userObject&lt;getMemberByKey(key=&quot;ssn&quot;)&gt; as $pii;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>从用户对象中提取信用卡号码或社会安全号码</li>
<li>用于个人信息保护合规性检查</li>
<li>检测敏感数据的不当处理</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getsiblings">getSiblings<a href="#getsiblings" class="hash-link" aria-label="Direct link to getSiblings" title="Direct link to getSiblings">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-3">作用<a href="#作用-3" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的兄弟指令。如果指令是一个对象的成员，可以通过这个指令获取该对象的其他成员。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-8">示例<a href="#示例-8" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本兄弟成员获取</strong></p>
<p>假设有如下结构：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">password</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;secret&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">database</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;mydb&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">host</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;localhost&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.username&lt;getSiblings&gt; as $siblings;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.username</code> - 配置对象的username成员</li>
<li><code>&lt;getSiblings&gt;</code> - 获取username的兄弟成员</li>
<li>结果包含 password、database、host 等其他成员</li>
<li>用于分析对象结构的完整性</li>
</ul>
<p><strong>2. 安全配置检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.ssl_enabled&lt;getSiblings&gt;?{&lt;name&gt;?{have:&quot;password&quot;|&quot;key&quot;|&quot;secret&quot;}} as $sensitiveConfig;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.ssl_enabled</code> - SSL配置成员</li>
<li><code>&lt;getSiblings&gt;</code> - 获取同级的其他配置项</li>
<li><code>?{&lt;name&gt;?{have:&quot;password&quot;|&quot;key&quot;|&quot;secret&quot;}}</code> - 筛选敏感配置项</li>
<li>用于检查SSL配置附近是否有敏感信息泄露</li>
</ul>
<p><strong>3. 数据结构完整性验证</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.required_field&lt;getSiblings&gt;?{!have:optional} as $mandatoryFields;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.required_field</code> - 必填字段</li>
<li><code>&lt;getSiblings&gt;</code> - 获取同级字段</li>
<li><code>?{!have:optional}</code> - 筛选非可选字段</li>
<li>用于验证数据结构的必填字段完整性</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用说明</div><div class="admonitionContent_BuS1"><p>由于getSiblings在实际项目中使用较少，上述示例主要用于说明概念。实际使用时，getMembers通常能满足大部分获取对象成员的需求。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="name">name<a href="#name" class="hash-link" aria-label="Direct link to name" title="Direct link to name">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-4">作用<a href="#作用-4" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的名称表示，例如函数名、变量名、方法名或字段名等。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-9">示例<a href="#示例-9" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基础函数名提取 :</strong></p>
<p>测试代码：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function-variable function" style="color:#d73a49">funcA</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;abc&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">funcA&lt;name&gt; as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：直接从函数定义中提取函数名，结果为&quot;funcA&quot;</p>
<p>**2. 链式调用中的方法名提取 **</p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String one() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var aArgs = new String[]{&quot;aaaaaaa&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xxeController.yourMethod(aArgs);  // 这里调用了yourMethod方法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aArgs&lt;getCall&gt;&lt;getCallee&gt;&lt;name&gt; as $sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>aArgs&lt;getCall&gt;</code> - 找到使用aArgs变量的调用指令</li>
<li><code>&lt;getCallee&gt;</code> - 获取被调用的函数（yourMethod）</li>
<li><code>&lt;name&gt;</code> - 提取函数名称，结果为&quot;yourMethod&quot;</li>
</ul>
<p><strong>3. SQL注入检测中的函数名匹配 :</strong></p>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$params&lt;getCallee&gt;?{&lt;name&gt;?{have:toString}}&lt;getObject&gt;.append(,* as $appendParams)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$params&lt;getCallee&gt;</code> - 从参数获取被调用的方法</li>
<li><code>?{&lt;name&gt;?{have:toString}}</code> - 检查方法名是否包含&quot;toString&quot;</li>
<li><code>&lt;getObject&gt;.append</code> - 获取调用对象并查找append方法</li>
<li>用于检测通过toString()转换后进行字符串拼接的SQL注入模式</li>
</ul>
<p><strong>4. XSS过滤函数检测 :</strong></p>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$calls?{&lt;getCallee&gt;&lt;name&gt;?{have: /(?i)(sanitiz|encod(e|ing)|entit(y|ies)|escap(e|ing)|replace|regex|normaliz|canonical|anti|safe|purif|purg|pure|validate|strip|clean|clear|special|convert|remov)/}} as $__next</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$calls?{&lt;getCallee&gt;&lt;name&gt;</code> - 获取调用指令的被调用函数名</li>
<li><code>?{have: /(?i)(...)/}</code> - 使用正则表达式匹配常见的安全过滤函数名</li>
<li>正则包含sanitize、encode、escape、replace等安全函数的变体</li>
<li>用于识别XSS防护中的过滤函数调用</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="string">string<a href="#string" class="hash-link" aria-label="Direct link to string" title="Direct link to string">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-5">作用<a href="#作用-5" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取输入指令的字符串表示，返回该指令在代码中的文本形式。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-10">示例<a href="#示例-10" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p>**1. 版本检测中的字符串提取 **</p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class VersionTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String version = &quot;1.2.3&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    String config = &quot;app.version=2.1.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">version&lt;string&gt; as $versionString;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：提取version变量的字符串值，用于后续版本比较分析</p>
<p><strong>2. 常量字符串处理:</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;127.0.0.1&quot;&lt;string&gt; as $ipString;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：获取IP地址常量的字符串表示，结果为&quot;127.0.0.1&quot;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eval">eval<a href="#eval" class="hash-link" aria-label="Direct link to eval" title="Direct link to eval">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-6">作用<a href="#作用-6" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>动态执行 SyntaxFlow 代码，支持在运行时构建和执行规则。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-11">示例<a href="#示例-11" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 动态执行简单规则</strong></p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String one() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var aArgs = new String[]{&quot;aaaaaaa&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xxeController.yourMethod(aArgs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;eval(&#x27;aArgs&lt;getCall&gt;&lt;getCallee&gt;&lt;name&gt; as $sink&#x27;)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>动态执行包含在字符串中的SyntaxFlow规则</li>
<li>该规则获取aArgs的调用、被调用者的名称</li>
<li>结果找到&quot;yourMethod&quot;</li>
</ul>
<p><strong>2. 配合show调试</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;eval(&#x27;aArgs&lt;getCall&gt;&lt;getCallee&gt;&lt;show&gt;&lt;name&gt; as $sink&#x27;)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>在动态执行的规则中加入show进行调试</li>
<li>可以查看中间步骤的执行结果</li>
</ul>
<p><strong>3. 执行变量中的代码</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;fuzztag(&#x27;aArgs&lt;getCall&gt;{{getCallee}}&lt;name&gt; as $sink&#x27;)&gt; as $code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;eval($code)&gt;&lt;show&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>先用fuzztag生成动态代码存储在$code变量中</li>
<li>再用eval执行$code变量中的SyntaxFlow规则</li>
<li>实现更灵活的动态规则构建</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="fuzztag">fuzztag<a href="#fuzztag" class="hash-link" aria-label="Direct link to fuzztag" title="Direct link to fuzztag">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-7">作用<a href="#作用-7" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>执行 yaklang fuzztag 模板，支持动态生成SyntaxFlow规则代码，变量在 SFFrameResult 中可用。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-12">示例<a href="#示例-12" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 动态模板生成</strong></p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public String one() throws Exception {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var aArgs = new String[]{&quot;aaaaaaa&quot;};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    xxeController.yourMethod(aArgs);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;fuzztag(&quot;&lt;getCallee&gt;&quot;)&gt; as $templateVar;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;fuzztag(&#x27;aArgs&lt;getCall&gt;{{templateVar}}&lt;name&gt; as $sink&#x27;)&gt; as $code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;eval($code)&gt;&lt;show&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>第一步：<code>&lt;fuzztag(&quot;&lt;getCallee&gt;&quot;)&gt;</code> 生成模板片段</li>
<li>第二步：使用<code>{{templateVar}}</code>将片段插入到新的模板中</li>
<li>第三步：用eval执行生成的完整规则</li>
<li>实现了SyntaxFlow规则的动态组装</li>
</ul>
<p><strong>2. 批量变量生成</strong></p>
<p>测试代码：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a1</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">a2</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">a3</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;fuzztag(&#x27;a{{int(1-3)}} as $sink&#x27;)&gt;&lt;eval&gt;&lt;show&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">check $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>{{int(1-3)}}</code> 生成1到3的整数序列</li>
<li>生成多个规则：a1 as $sink, a2 as $sink, a3 as $sink</li>
<li>批量匹配多个相似变量</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="show">show<a href="#show" class="hash-link" aria-label="Direct link to show" title="Direct link to show">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-8">作用<a href="#作用-8" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>显示中间过程的值，主要用于调试和开发阶段，不对数据流产生影响。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-13">示例<a href="#示例-13" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 调试链式调用过程 :</strong></p>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aArgs&lt;getCall&gt;&lt;getCallee&gt;&lt;show&gt;&lt;name&gt; as $sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>aArgs&lt;getCall&gt;&lt;getCallee&gt;</code> - 获取被调用的函数</li>
<li><code>&lt;show&gt;</code> - 在控制台显示函数对象的详细信息</li>
<li><code>&lt;name&gt;</code> - 继续提取函数名</li>
<li>用于调试时查看中间步骤的值</li>
</ul>
<p><strong>2. MyBatis注解值调试 :</strong></p>
<p>SyntaxFlow规则：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.annotation.Select.value&lt;show&gt;&lt;regexp(\$\{\s*(\w+)\s*\}, group=1)&gt; as $entry;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.annotation.Select.value</code> - 获取Select注解的value值</li>
<li><code>&lt;show&gt;</code> - 显示注解的原始值，便于调试正则表达式</li>
<li><code>&lt;regexp(...)&gt;</code> - 使用正则提取占位符中的变量名</li>
<li>常用于调试MyBatis注解解析过程</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="slice">slice<a href="#slice" class="hash-link" aria-label="Direct link to slice" title="Direct link to slice">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-9">作用<a href="#作用-9" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>对值进行切片操作，支持从数组、参数列表等容器类型中提取子  集或特定元素。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-14">示例<a href="#示例-14" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 函数参数切片提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hijackHTTPRequest&lt;slice(index=0)&gt; as $param0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hijackHTTPRequest&lt;slice(index=1)&gt; as $param1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hijackHTTPRequest&lt;slice(index=2)&gt; as $param2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;slice(index=0)&gt;</code> - 获取第0个参数</li>
<li><code>&lt;slice(index=1)&gt;</code> - 获取第1个参数</li>
<li>用于从HTTP劫持函数中提取特定位置的参数</li>
</ul>
<p><strong>2. 密码相关参数提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldap_bind(*&lt;slice(start=2)&gt;?{opcode: const} as $pass)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>*&lt;slice(start=2)&gt;</code> - 获取第2个参数及之后的所有参数</li>
<li><code>?{opcode: const}</code> - 筛选常量类型的参数</li>
<li>用于检测LDAP绑定中的硬编码密码</li>
</ul>
<p><strong>3. LDAP注入检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ldap_search(*&lt;slice(start=1)&gt; as $query);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ldap_compare(*&lt;slice(index=1)&gt; as $query);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;slice(start=1)&gt;</code> - 获取第1个参数及之后的参数（查询参数）</li>
<li><code>&lt;slice(index=1)&gt;</code> - 获取第1个参数（比较查询）</li>
<li>用于检测LDAP查询注入漏洞</li>
</ul>
<p><strong>4. 加密算法参数提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">AlgorithmParameters?{&lt;typeName&gt;?{have:&quot;java.security.AlgorithmParameters&quot;}}.getInstance(*&lt;slice(index=1)&gt; as $algorithm);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;slice(index=1)&gt;</code> - 获取第1个参数（算法名称）</li>
<li>用于检测弱加密算法的使用</li>
<li>分析加密配置的安全性</li>
</ul>
<p><strong>5. SQL注入参数提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*sql*.append(*&lt;slice(start=1)&gt; as $params);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;slice(start=1)&gt;</code> - 获取append方法的所有参数</li>
<li>用于检测SQL字符串拼接注入</li>
<li>分析动态SQL构建的安全性</li>
</ul>
<p><strong>6. 文件操作参数提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FileReader(*&lt;slice(index=1)&gt; as $fileReader);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;slice(index=1)&gt;</code> - 获取第1个参数（文件路径）</li>
<li>用于检测文件路径遍历漏洞</li>
<li>分析文件操作的安全性</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="regexp">regexp<a href="#regexp" class="hash-link" aria-label="Direct link to regexp" title="Direct link to regexp">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-10">作用<a href="#作用-10" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>对字符串进行正则表达式匹配，支持分组提取和模式匹配。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-15">示例<a href="#示例-15" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p>**1. MyBatis SQL 参数提取 **</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Select(&quot;select * from users where id = #{user_id} and name = #{user_name}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public User getUserById(String userId, String userName);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.annotation.Select.value&lt;regexp(\$\{\s*(\w+)\s*\}, group=1)&gt; as $entry;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>从Select注解的value值中提取MyBatis参数</li>
<li>正则表达式 <code>\$\{\s*(\w+)\s*\}</code> 匹配 <code>#{param}</code> 格式</li>
<li><code>group=1</code> 提取第一个分组，即参数名</li>
<li>结果提取出 &quot;user_id&quot; 和 &quot;user_name&quot;</li>
</ul>
<p><strong>2. 基本字符串匹配</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 提取正则匹配的分组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;abc123def&quot;&lt;regexp(`(\d+)`, group: 1)&gt; as $result;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：从字符串中提取数字部分，结果为 &quot;123&quot;</p>
<p><strong>3. URL路径提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;/api/users/123&quot;&lt;regexp(`/api/(\w+)/(\d+)`, group: 2)&gt; as $userId;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：从URL路径中提取用户ID，结果为 &quot;123&quot;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strlower">strlower<a href="#strlower" class="hash-link" aria-label="Direct link to strlower" title="Direct link to strlower">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-11">作用<a href="#作用-11" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>将字符串转换为小写形式。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-16">示例<a href="#示例-16" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本字符串转换</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;Hello World&quot;&lt;strlower&gt; as $result;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：将字符串转换为小写，结果为 &quot;hello world&quot;</p>
<p><strong>2. 方法名标准化处理</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">method&lt;name&gt;&lt;strlower&gt; as $normalizedName;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：获取方法名并转换为小写，用于不区分大小写的匹配</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="strupper">strupper<a href="#strupper" class="hash-link" aria-label="Direct link to strupper" title="Direct link to strupper">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-12">作用<a href="#作用-12" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>将字符串转换为大写形式。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-17">示例<a href="#示例-17" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基 本字符串转换</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;hello world&quot;&lt;strupper&gt; as $result;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：将字符串转换为大写，结果为 &quot;HELLO WORLD&quot;</p>
<p><strong>2. 常量名规范化</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">constantValue&lt;strupper&gt; as $upperConstant;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：将常量值转换为大写，用于符合命名约定</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="var">var<a href="#var" class="hash-link" aria-label="Direct link to var" title="Direct link to var">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-13">作用<a href="#作用-13" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>将值存储到变量表中，用于在SyntaxFlow规则中创建可重用的变量引用。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-18">示例<a href="#示例-18" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本变量存储</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">result&lt;var(name=&quot;myVar&quot;)&gt; as $stored;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：将result值存储到名为&quot;myVar&quot;的变量中</p>
<p><strong>2. 中间结果缓存</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">userInput&lt;getFormalParams&gt;&lt;var(name=&quot;params&quot;)&gt; as $cachedParams;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：将函数参数缓存到变量中，便于后续规则引用</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="opcodes">opcodes<a href="#opcodes" class="hash-link" aria-label="Direct link to opcodes" title="Direct link to opcodes">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-14">作用<a href="#作用-14" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取值所在函数中所有操作码的类型列表，用于分析函数的复杂度和结构特征。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-19">示例<a href="#示例-19" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p>**1. 复杂函数分析 **</p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public int methodA(int a) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        println(this.num);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        b=6+6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        a = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (c){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a=22;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if(d){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                bb = !true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int[] myArray = {1, 2, 3, 4, 5};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a=33;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prinln(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i=0;i&lt;10;i++){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a+=i;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        switch(a){}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }catch (Exception e){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a&lt;opcodes&gt; as $allOpcodes;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取函数methodA中所有指令的操作码类型</li>
<li>结果包含: Parameter, ParameterMember, Return, Loop, Function, Call, Phi, Undefined, ConstInst, Jump, If, UnOp, Switch, ErrorHandler, Make, BinOp</li>
<li>可以用于分析函数的控制流复杂度和语言特性使用情况</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sourcecode">sourceCode<a href="#sourcecode" class="hash-link" aria-label="Direct link to sourceCode" title="Direct link to sourceCode">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-15">作用<a href="#作用-15" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取指令对应的源代码文本，支持带上下文的代码提取。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-20">示例<a href="#示例-20" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p>**1. 基本源代码提取 **</p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b=6+6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (c){</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bb1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bb2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prinln(a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bb1&lt;sourceCode&gt; as $code;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：获取bb1语句的源代码，结果为 <code>&quot;bb1;\n&quot;</code></p>
<p><strong>2. 带上下文的源代码提取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">bb2&lt;sourceCode(context=3)&gt; as $contextCode;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取bb2语句及其前后3行的上下文代码</li>
<li>结果包含完整的if-else结构和周围代码</li>
<li>用于代码审计时需要查看完整上下文的场景</li>
</ul>
<p><strong>3. 函数完整源码获取</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">method&lt;sourceCode&gt; as $functionCode;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：获取整个方法的源代码文本</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scannext">scanNext<a href="#scannext" class="hash-link" aria-label="Direct link to scanNext" title="Direct link to scanNext">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-16">作用<a href="#作用-16" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>扫描下一个指令，用于顺序分析代码执行流程。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-21">示例<a href="#示例-21" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">currentInstruction&lt;scanNext&gt; as $nextInstruction;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取当前指令的下一个执行指令</li>
<li>用于控制流分析和代码执行路径追踪</li>
<li>在分析代码执行序列时非常有用</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用说明</div><div class="admonitionContent_BuS1"><p>由于scanNext在实际项目中使用较少，主要用于底层的控制流分析。大多数情况下，数据流分析（<code>#-&gt;</code>）能满足分析需求。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scanprevious">scanPrevious<a href="#scanprevious" class="hash-link" aria-label="Direct link to scanPrevious" title="Direct link to scanPrevious">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-17">作用<a href="#作用-17" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>扫描前一个指令，用于逆向分析代码执行流程。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-22">示例<a href="#示例-22" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">currentInstruction&lt;scanPrevious&gt; as $previousInstruction;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取当前指令的前一个执行指令</li>
<li>用于逆向控制流分析</li>
<li>在追踪指令来源时有用</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用说明</div><div class="admonitionContent_BuS1"><p>scanPrevious主要用于专门的控制流分析场景。一般的数据流追踪建议使用<code>getPredecessors</code>。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scaninstruction">scanInstruction<a href="#scaninstruction" class="hash-link" aria-label="Direct link to scanInstruction" title="Direct link to scanInstruction">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-18">作用<a href="#作用-18" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>扫描当前基本块中的所有指令。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-23">示例<a href="#示例-23" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">value&lt;scanInstruction&gt; as $blockInstructions;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取当前基本块内的所有指令列表</li>
<li>用于分析基本块的指令组成</li>
<li>在静态分析中用于理解代码块结构</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>使用说明</div><div class="admonitionContent_BuS1"><p>scanInstruction主要用于编译器级别的分析。对于安全分析，通常使用<code>foreach_function_inst</code>更为合适。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="const">const<a href="#const" class="hash-link" aria-label="Direct link to const" title="Direct link to const">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-19">作用<a href="#作用-19" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>搜索程序中的常量值，支持多种匹配模式：精确匹配、通配符匹配、正则表达式匹配等。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-24">示例<a href="#示例-24" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p>**1. 通配符匹配 **</p>
<p>测试代码：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(g=&quot;127*&quot;)&gt; as $output</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>g=&quot;127*&quot;</code> - 使用通配符模式匹配以&quot;127&quot;开头的常量</li>
<li>结果找到 &quot;127.0.0.1&quot;</li>
</ul>
<p><strong>2. 正则表达式匹配</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(r=&quot;^((0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])\.){3}(0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])$&quot;)&gt; as $ipAddresses</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>r=&quot;...&quot;</code> - 使用正则表达式匹配IP地址格式</li>
<li>正则表达式验证IPv4地址的合法性</li>
</ul>
<p><strong>3. 精确匹配</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(e=&quot;127.0.0.1&quot;)&gt; as $exactMatch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>e=&quot;127.0.0.1&quot;</code> - 精确匹配指定的字符串常量</li>
<li>只匹配完全相同的值</li>
</ul>
<p><strong>4. Here Document 匹配</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;127.0.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt; as $heredocMatch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>支持多行字符串的常量匹配</li>
<li>适用于复杂的字符串模式</li>
</ul>
<p><strong>5. SSRF 过滤检测 :</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$input&lt;const(r=&quot;([?#]|[^?#:/\\\\][/\\\\])|^/$&quot;)&gt; as $output;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检测可能绕过SSRF过滤的特殊字符模式</li>
<li>用于识别URL中的危险字符组合</li>
</ul>
<p><strong>6. 语法糖形式</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&quot;127*&quot; as $globMatch      // 等同于 &lt;const(g=&quot;127*&quot;)&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e&quot;127.0.0.1&quot; as $exact    // 等同于 &lt;const(e=&quot;127.0.0.1&quot;)&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r&quot;^\d+\.\d+\.\d+\.\d+$&quot; as $regex  // 等同于 &lt;const(r=&quot;...&quot;)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：SyntaxFlow提供了更简洁的语法糖形式来表达常量匹配</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 精确匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(e=&quot;127.0.0.1&quot;)&gt; as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 全局匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(g=&quot;127*&quot;)&gt; as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 正则匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(r=`^((0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])\.){3}(0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])$`)&gt; as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 自动模式（语法糖）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;127*&quot; as $output;  // 全局匹配</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;127.0.0.1&quot; as $output;  // 精确匹配</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>使用示例：</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;127.0.0.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(g=&quot;127*&quot;)&gt; as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果: &quot;127.0.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;const(r=`^((0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])\.){3}(0|[1-9]\d?|1\d\d|2[0-4]\d|25[0-5])$`)&gt; as $output;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果: &quot;127.0.0.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="versionin">versionIn<a href="#versionin" class="hash-link" aria-label="Direct link to versionIn" title="Direct link to versionIn">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-20">作用<a href="#作用-20" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>检查版本是否在指定范围内，用于依赖库漏洞检测和版本兼容性分析。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-25">示例<a href="#示例-25" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. Maven依赖版本检测</strong></p>
<p>测试代码（pom.xml）：</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">fastjson</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.2.24</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">__dependency__.*fastjson.version as $ver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:(0.1.0,1.3.0]} as $vulnVersion</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>__dependency__.*fastjson.version</code> - 获取fastjson依赖的版本</li>
<li><code>version_in:(0.1.0,1.3.0]</code> - 检查版本是否在区间(0.1.0, 1.3.0]内</li>
<li>用于检测存在漏洞的fastjson版本</li>
</ul>
<p><strong>2. 版本范围语法</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 开区间：不包含边界值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:(1.0.0,2.0.0)} as $result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 闭区间：包含边界值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:[1.0.0,2.0.0]} as $result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 混合区间：左开右闭</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:(1.0.0,2.0.0]} as $result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 开放边界：无上限</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:[1.2.24,)} as $result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 开放边界：无下限</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:(,1.2.24]} as $result</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>3. 复杂版本条件</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">__dependency__.*fastjson.version as $ver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ver?{version_in:(0.1.0,1.3.0]||(1.1.0,2.3.0]} as $vulnVersion</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>使用<code>||</code>连接多个版本区间</li>
<li>检查版本是否在任一区间内</li>
<li>适用于有多个漏洞版本范围的情况</li>
</ul>
<p><strong>4. 语法糖形式</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ver in (0.1.0,1.3.0] as $vulnVersion</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：使用<code>in</code>关键字作为<code>version_in</code>的简写形式</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dataflow">dataflow<a href="#dataflow" class="hash-link" aria-label="Direct link to dataflow" title="Direct link to dataflow">​</a></h3>
<p><code>dataflow</code> 用于获取数据流。如果你想获取数据流，在 <code>--&gt;</code> 或 <code>#-&gt;</code> 之后调用 <code>&lt;dataflow...&gt;</code>。</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取数据流</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$data&lt;dataflow(&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: call &amp;&amp; &lt;getCallee&gt;&lt;name&gt;?{name} }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="self">self<a href="#self" class="hash-link" aria-label="Direct link to self" title="Direct link to self">​</a></h3>
<p><code>self</code> 用于获取自身值。</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取自身值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">value&lt;self&gt; as $self;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="forbid">forbid<a href="#forbid" class="hash-link" aria-label="Direct link to forbid" title="Direct link to forbid">​</a></h3>
<p><code>forbid</code> 用于禁止一个值，如果值存在，报告严重错误。</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 禁止特定变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;forbid(var=&quot;variableName&quot;)&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 禁止当前值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">value&lt;forbid&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>使用示例：</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function-variable function" style="color:#d73a49">a</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">b&lt;show&gt;&lt;forbid&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 结果: 如果 b 存在，报告严重错误</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="delete">delete<a href="#delete" class="hash-link" aria-label="Direct link to delete" title="Direct link to delete">​</a></h3>
<p><code>delete</code> 用于删除变量。</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 删除变量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;delete(name=&quot;variableName&quot;)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getusers">getUsers<a href="#getusers" class="hash-link" aria-label="Direct link to getUsers" title="Direct link to getUsers">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-21">作用<a href="#作用-21" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取值的使用者（Users），即哪些指令使用了当前值，常用于数据流分析和未使用返回值检测。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-26">示例<a href="#示例-26" class="hash-link" aria-label="Direct link to 示例" title="Direct link to  示例">​</a></h4>
<p><strong>1. 异常处理检查</strong></p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // some risky operation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} catch (Exception e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // e is caught but not used</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$exception&lt;getUsers&gt;?{!opcode:catch} as $users</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$exception&lt;getUsers&gt;</code> - 获取异常变量的使用者</li>
<li><code>?{!opcode:catch}</code> - 排除catch语句本身</li>
<li>用于检测异常是否被实际处理而不是被忽略</li>
</ul>
<p><strong>2. 未检查返回值检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$toCheck?{&lt;typeName&gt;?{have:&#x27;java.lang&#x27;}}?{!&lt;getUsers&gt;} as $weak;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$toCheck</code> - 需要检查的方法调用</li>
<li><code>&lt;typeName&gt;?{have:&#x27;java.lang&#x27;}</code> - 筛选java.lang包的方法</li>
<li><code>?{!&lt;getUsers&gt;}</code> - 检查返回值是否没有被使用</li>
<li>用于发现未检查返回值的潜在bug</li>
</ul>
<p><strong>3. 空指针检查深度分析</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$haveMemberCall?{!&lt;getUsers(depth=2)&gt;?{opcode:if} &amp;&amp; !&lt;getUsers(depth=3)&gt;?{opcode:if}} as $weak</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;getUsers(depth=2)&gt;</code> - 获取深度为2的使用者</li>
<li><code>&lt;getUsers(depth=3)&gt;</code> - 获取深度为3的使用者</li>
<li><code>?{opcode:if}</code> - 检查是否被if语句使用</li>
<li>用于检测可能返回null的方法调用是否进行了空值检查</li>
</ul>
<p><strong>4. 锁检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.tryLock()?{&lt;typeName&gt;?{have:&#x27;java.util.concurrent.locks&#x27;}}?{!&lt;getUsers&gt;} as $weak;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.tryLock()</code> - 尝试获取锁的操作</li>
<li><code>?{!&lt;getUsers&gt;}</code> - 检查tryLock的返回值是否被使用</li>
<li>用于检测未检查锁获取结果的并发安全问题</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getpredecessors">getPredecessors<a href="#getpredecessors" class="hash-link" aria-label="Direct link to getPredecessors" title="Direct link to getPredecessors">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-22">作用<a href="#作用-22" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取值的前驱节点，用于逆向数据流分析，追踪值的来源和传播路径。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-27">示例<a href="#示例-27" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本前驱分析</strong></p>
<p>测试代码：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">222</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a.b as $b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$b&lt;getPredecessors&gt; as $ret</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>a.b</code> - 获取对象a的成员b</li>
<li><code>&lt;getPredecessors&gt;</code> - 获取b的前驱节点</li>
<li>结果为 &quot;111&quot;，即a的原始值</li>
<li>用于追踪成员变量的源头值</li>
</ul>
<p><strong>2. 数据流前驱追踪</strong></p>
<p>测试代码：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">foo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">b #-&gt; as $top_b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$top_b&lt;getPredecessors&gt; as $b</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>b #-&gt;</code> - 获取b的数据流传播</li>
<li><code>&lt;getPredecessors&gt;</code> - 获取传播链的前驱</li>
<li>结果为 &quot;Function-foo(2)&quot;，即函数调用</li>
<li>用于分析复杂数据流的传播链</li>
</ul>
<p><strong>3. 命令注入源头追踪</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$controlled_source_site&lt;getPredecessors()&gt; as $controlled_sink_site</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$controlled_source_site</code> - 受控制的数据源</li>
<li><code>&lt;getPredecessors()&gt;</code> - 追踪数据的前驱传播</li>
<li>用于追踪命令注入漏洞中危险数据的来源</li>
</ul>
<p><strong>4. 资源安全检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$safe&lt;getPredecessors()&gt; as $safeGetConnection;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$safe</code> - 安全的资源释放点</li>
<li><code>&lt;getPredecessors()&gt;</code> - 追踪释放点的前驱</li>
<li>用于确认资源是否被正确获取和释放</li>
</ul>
<p><strong>5. 日志注入检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$dest&lt;getPredecessors&gt; as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$dest</code> - 日志输出目标</li>
<li><code>&lt;getPredecessors&gt;</code> - 追踪日志内容的来源</li>
<li>用于检测日志伪造漏洞中的不安全输入源</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getactualparams">getActualParams<a href="#getactualparams" class="hash-link" aria-label="Direct link to getActualParams" title="Direct link to getActualParams">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-23">作用<a href="#作用-23" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取函数调用的实际参数列表，用于分析函数调用时传入的具体参数。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-28">示例<a href="#示例-28" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. DoS攻击检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.waitFor?{!(&lt;getActualParams&gt;&lt;slice(start=1)&gt;)}(* as $process,)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.waitFor</code> - 进程等待方法</li>
<li><code>&lt;getActualParams&gt;&lt;slice(start=1)&gt;</code> - 获取第二个参数开始的所有参数</li>
<li><code>?{!(...)}</code> - 检查是否没有超时参数</li>
<li>用于检测可能导致DoS的无限等待</li>
</ul>
<p><strong>2. 不安全类型转换检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$string_constructor?{&lt;getActualParams()&gt;* &lt;fullTypeName()&gt;?{have:&quot;byte&quot;}} as $target</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>$string_constructor</code> - String构造函数</li>
<li><code>&lt;getActualParams()&gt;</code> - 获取构造函数的实际参数</li>
<li><code>&lt;fullTypeName()&gt;?{have:&quot;byte&quot;}</code> - 检查参数类型是否包含byte</li>
<li>用于检测不安全的字节数组到字符串转换</li>
</ul>
<p><strong>3. 加密算法配置检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// $set?{&lt;getActualParams&gt;&lt;slice(index=1)&gt;?{have:&#x27;jasypt.encryptor.algorithm&#x27;}} as $toCheck;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// $toCheck&lt;getActualParams&gt;&lt;slice(index=2)&gt;?{have:&#x27;MD5&#x27;} as $algorithm;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取系统配置方法的实际参数</li>
<li>检查加密算法配置是否使用了不安全的MD5</li>
<li>用于发现弱加密算法配置</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getactualparamlen">getActualParamLen<a href="#getactualparamlen" class="hash-link" aria-label="Direct link to getActualParamLen" title="Direct link to getActualParamLen">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-24">作用<a href="#作用-24" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取函数调用的实际参数数量，常用于参数数量验证和API使用检查。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-29">示例<a href="#示例-29" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 与len的区别</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取调用的参数数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">functionCall&lt;getActualParamLen&gt; as $paramCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 等价于</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">functionCall&lt;getActualParams&gt;&lt;len&gt; as $paramCount;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;getActualParamLen&gt;</code> 是获取参数长度的便捷方法</li>
<li>直接返回数字，而不需要先获取参数再计算长度</li>
</ul>
<p><strong>2. API调用验证</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">riskyMethod?{&lt;getActualParamLen&gt;?{&lt;3}} as $insufficientParams;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检查危险方法调用是否提供了足够的参数</li>
<li>参数不足可能导致安全问题</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getcurrentblueprint">getCurrentBlueprint<a href="#getcurrentblueprint" class="hash-link" aria-label="Direct link to getCurrentBlueprint" title="Direct link to getCurrentBlueprint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-25">作用<a href="#作用-25" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取当前函数的蓝图信息，只能在函数上下文中使用，用于获取函数自身的类型和结构信息。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-30">示例<a href="#示例-30" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取当前函数蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mainFunction&lt;getCurrentBlueprint&gt; as $blueprint;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>只有函数可以使用此NativeCall</li>
<li>返回函数的类型签名和结构信息</li>
<li>用于函数自省和类型分析</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getblueprint">getBluePrint<a href="#getblueprint" class="hash-link" aria-label="Direct link to getBluePrint" title="Direct link to getBluePrint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-26">作用<a href="#作用-26" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取任意值的蓝图信息，包括类型定义、结构信息等。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-31">示例<a href="#示例-31" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取变量蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userObject&lt;getBluePrint&gt; as $blueprint;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取类蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MyClass&lt;getBluePrint&gt; as $classBlueprint;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>可以应用于任何值或类型</li>
<li>返回详细的类型结构信息</li>
<li>用于类型系统分析和代码理解</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getparentsblueprint">getParentsBlueprint<a href="#getparentsblueprint" class="hash-link" aria-label="Direct link to getParentsBlueprint" title="Direct link to getParentsBlueprint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-27">作用<a href="#作用-27" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取类的父类蓝图信息，用于继承关系分析。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-32">示例<a href="#示例-32" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取父类蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ChildClass&lt;getParentsBlueprint&gt; as $parents;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>返回类的所有直接父类信息</li>
<li>用于继承链分析</li>
<li>帮助理解类的层次结构</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getinterfaceblueprint">getInterfaceBlueprint<a href="#getinterfaceblueprint" class="hash-link" aria-label="Direct link to getInterfaceBlueprint" title="Direct link to getInterfaceBlueprint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-28">作用<a href="#作用-28" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取类实现的接口蓝图信息。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-33">示例<a href="#示例-33" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取接口蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ConcreteClass&lt;getInterfaceBlueprint&gt; as $interfaces;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>返回类实现的所有接口信息</li>
<li>用于接口实现分析</li>
<li>帮助理解类的行为契约</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getrootparentblueprint">getRootParentBlueprint<a href="#getrootparentblueprint" class="hash-link" aria-label="Direct link to getRootParentBlueprint" title="Direct link to getRootParentBlueprint">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-29">作用<a href="#作用-29" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取继承链的根父类蓝图信息。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-34">示例<a href="#示例-34" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取根父类蓝图</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DeepChildClass&lt;getRootParentBlueprint&gt; as $root;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>追溯到继承链的最顶层父类</li>
<li>用于分析类的最终基础类型</li>
<li>帮助理解类的根本结构</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="extendsby">extendsBy<a href="#extendsby" class="hash-link" aria-label="Direct link to extendsBy" title="Direct link to extendsBy">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-30">作用<a href="#作用-30" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>判断类的继承关系，检查一个类是否继承自另一个类。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-35">示例<a href="#示例-35" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本继承检查</strong></p>
<p>Java代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Animal {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Dog extends Animal {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Cat extends Animal {}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Dog&lt;extendsBy($Animal)&gt; as $isDogAnimal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cat&lt;extendsBy($Animal)&gt; as $isCatAnimal;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dog&lt;extendsBy($Cat)&gt; as $isDogCat;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>Dog&lt;extendsBy($Animal)&gt;</code> - 检查Dog是否继承自Animal（true）</li>
<li><code>Cat&lt;extendsBy($Animal)&gt;</code> - 检查Cat是否继承自Animal（true）</li>
<li><code>Dog&lt;extendsBy($Cat)&gt;</code> - 检查Dog是否继承自Cat（false）</li>
</ul>
<p><strong>2. 多层继承检查</strong></p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class Vehicle {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class Car extends Vehicle {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">class SportsCar extends Car {}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SportsCar&lt;extendsBy($Vehicle)&gt; as $isVehicle;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SportsCar&lt;extendsBy($Car)&gt; as $isCar;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>支持多层  继承关系检查</li>
<li>可以检测间接继承关系</li>
</ul>
<p><strong>3. 安全分析中的应用</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">userClass&lt;extendsBy($TrustedBase)&gt; as $isTrusted;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$isTrusted?{==false} as $untrustedClasses;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检查用户定义的类是否继承自可信基类</li>
<li>用于识别潜在的不安全类实现</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="len">len<a href="#len" class="hash-link" aria-label="Direct link to len" title="Direct link to len">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-31">作用<a href="#作用-31" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取数组、列表、参数列表等容器的长度，常用于参数数量检查和安全分析。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-36">示例<a href="#示例-36" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 函数参数数量检查</strong></p>
<p>测试代码：</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;param1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;param2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">a</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;param1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;param2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;param3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a?(*&lt;len&gt;?{==2}) as $result</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>a?(*)</code> - 获取函数a的所有调用</li>
<li><code>&lt;len&gt;</code> - 获取参数列表的长度</li>
<li><code>?{==2}</code> - 筛选参数数量等于2的调用</li>
<li>用于识别特定参数数量的函数调用</li>
</ul>
<p><strong>2. PHP Cookie安全检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setcookie?(*&lt;len&gt;?{&lt;6}) as $sinkCookie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setcookie?(*&lt;len&gt;?{==6}) as $checkCookie</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">setcookie?(*&lt;len&gt;?{&lt;=6}) as $noHttpOnlyCookie</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检查setcookie函数的参数数量</li>
<li><code>&lt;6</code> - 参数少于6个可能缺少安全配置</li>
<li><code>==6</code> - 正确的参数数量</li>
<li><code>&lt;=6</code> - 可能缺少HttpOnly等安全标志</li>
</ul>
<p><strong>3. Java系统属性检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">System.getProperty?(*&lt;len()&gt;?{==2}) as $getProperty;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Integer.getInteger?(*&lt;len()&gt;?{==2}) as $getInteger;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">System.setProperty?(*&lt;len()&gt;?{==3}) as $setProperty;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检查系统属性相关方法的参数数量</li>
<li>getProperty和getInteger应该有2个参数</li>
<li>setProperty应该有3个参数</li>
<li>用于检测可能的空指针引用漏洞</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="root">root<a href="#root" class="hash-link" aria-label="Direct link to root" title="Direct link to root">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-32">作用<a href="#作用-32" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取链式调用或成员访问的根对象，追踪到调用链的起始点。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-37">示例<a href="#示例-37" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 链式调用根对象获取</strong></p>
<p>测试代码：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">b</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.d&lt;root&gt; as $sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>.d</code> - 链式调用的最后一个方法</li>
<li><code>&lt;root&gt;</code> - 获取整个调用链的根对象</li>
<li>结果为 &quot;Undefined-a&quot;，即最初的对象a</li>
<li>用于追踪复杂调用链的起始对象</li>
</ul>
<p><strong>2. 深层成员访问追踪</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obj.method1().property.method2()&lt;root&gt; as $original</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>从深层的方法调用追踪到最初的对象</li>
<li>帮助理解数据流的起源</li>
</ul>
<p><strong>3. API调用源头分析</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">response.getData().getItems().get(0)&lt;root&gt; as $apiSource</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>追踪复杂API调用链的源头</li>
<li>用于分析数据来源和安全边界</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="filenamebycontent">FilenameByContent<a href="#filenamebycontent" class="hash-link" aria-label="Direct link to FilenameByContent" title="Direct link to FilenameByContent">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-33">作用<a href="#作用-33" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>根据代码中的值或类型获取其所在的文件名，常用于文件定位和模块分析。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-38">示例<a href="#示例-38" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 类文件定位</strong></p>
<p>测试文件结构：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">a.java - package main; public class A{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">b.java - package main2; public class B{}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">A as $output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$output&lt;FilenameByContent&gt; as $sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>A</code> - 引用类A</li>
<li><code>&lt;FilenameByContent&gt;</code> - 获取定义类A的文件名</li>
<li>结果为 &quot;a.java&quot;</li>
<li>用于确定某个类定义在哪个文件中</li>
</ul>
<p><strong>2. 多文件代码分析</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">B as $classB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$classB&lt;FilenameByContent&gt; as $fileName</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取类B所在的文件名</li>
<li>结果为 &quot;b.java&quot;</li>
<li>帮助分析代码的文件分布情况</li>
</ul>
<p><strong>3. 模块定位</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">specificFunction&lt;FilenameByContent&gt; as $moduleFile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>通过函数或变量定位其所在的模块文件</li>
<li>用于模块化项目的依赖关系分析</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="getfullfilename">getFullFileName<a href="#getfullfilename" class="hash-link" aria-label="Direct link to getFullFileName" title="Direct link to getFullFileName">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-34">作用<a href="#作用-34" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>根据文件名模式获取项目中的完整文件路径，用于批量文件分析和定位。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-39">示例<a href="#示例-39" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 按模式匹配文件</strong></p>
<p>文件结构：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/src/main/java/abc.java</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/src/main/java/bcd.java</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;getFullFileName(filename=&quot;*/a*&quot;)&gt; as $sink</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>filename=&quot;*/a*&quot;</code> - 匹配路径包含a开头文件名的所有文件</li>
<li>结果为 &quot;src/main/java/abc.java&quot;</li>
<li>支持glob模式匹配，用于批量文件分析</li>
</ul>
<p><strong>2. Java文件过滤</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;getFullFileName(filename=&quot;*.java&quot;)&gt; as $javaFiles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>获取所有Java源文件</li>
<li>用于项目范围的代码分析</li>
</ul>
<p><strong>3. 特定目录文件查找</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;getFullFileName(filename=&quot;*/test/*.java&quot;)&gt; as $testFiles</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;getFullFileName(filename=&quot;*/main/*.java&quot;)&gt; as $mainFiles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>分别获取测试文件和主要源文件</li>
<li>用于区分不同类型的代码文件</li>
</ul>
<p><strong>参数说明：</strong></p>
<ul>
<li><code>filename</code>: 文件名模式，支持 glob 通配符</li>
<li><code>*</code> 匹配任意字符</li>
<li><code>?</code> 匹配单个字符</li>
<li><code>*/</code> 匹配任意目录层级</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="foreach_function_inst">foreach_function_inst<a href="#foreach_function_inst" class="hash-link" aria-label="Direct link to foreach_function_inst" title="Direct link to foreach_function_inst">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-35">作用<a href="#作用-35" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>遍历函数内部的所有指令实例，允许在遍历过程中执行自定义的钩子函数。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-40">示例<a href="#示例-40" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 函数内常量收集</strong></p>
<p>测试代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">package com.example.A;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class A {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bb1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            a += i;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bb2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">main&lt;foreach_function_inst(hook=&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: const} as $output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>main</code> - 目标函数</li>
<li><code>&lt;foreach_function_inst(...)&gt;</code> - 遍历函数内部所有指令</li>
<li><code>hook=&lt;&lt;&lt;CODE ... CODE</code> - 定义遍历时的钩子逻辑</li>
<li><code>*?{opcode: const}</code> - 在每个指令中查找常量</li>
<li>结果为 <!-- -->1<!-- -->，即函数中所有的常量值</li>
</ul>
<p><strong>2. 指令类型统计</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">targetFunction&lt;foreach_function_inst(hook=`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: call} as $calls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: if} as $conditions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: assign} as $assignments</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>在函数遍历过程中分别收集不同类型的指令</li>
<li>可用于函数复杂度分析和代码质量评估</li>
</ul>
<p><strong>3. 安全检查模式</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">securityFunction&lt;foreach_function_inst(hook=`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{&lt;typeName&gt;?{have:&#x27;dangerous&#x27;}} as $riskyOps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{&lt;name&gt;?{have:&#x27;password&#x27;}} as $passwordOps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`)&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>在函数内部查找危险操作和密码相关操作</li>
<li>用于安全代码审计</li>
</ul>
<p><strong>参数说明：</strong></p>
<ul>
<li><code>hook</code>: 遍历过程中执行的SyntaxFlow代码片段</li>
<li>支持heredoc语法 <code>&lt;&lt;&lt;CODE ... CODE</code> 用于多行代码</li>
<li>钩子中可以定义多个变量收集不同类型的结果</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="javaunescapeoutput">javaUnescapeOutput<a href="#javaunescapeoutput" class="hash-link" aria-label="Direct link to javaUnescapeOutput" title="Direct link to javaUnescapeOutput">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-36">作用<a href="#作用-36" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>获取Java模板语言（JSP、Thymeleaf等）中未转义的输出，专门用于XSS漏洞检测。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-41">示例<a href="#示例-41" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. JSP XSS检测</strong></p>
<p>JSP模板：</p>
<div class="language-jsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;h2&gt;User Input:&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt;${sessionScope.userInput}&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;javaUnescapeOutput&gt; as $res</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>自动识别JSP中的 <code>${sessionScope.userInput}</code> 表达式</li>
<li>检测未转义的用户输入，可能导致XSS攻击</li>
<li>结果包含 &quot;sessionScope.userInput&quot;</li>
</ul>
<p><strong>2. Servlet + JSP XSS检测链</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;javaUnescapeOutput&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request?{opcode:param &amp;&amp; &lt;typeName&gt;?{have:&#x27;javax.servlet.http.HttpServlet&#x27;}} as $source;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink #{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    include:&lt;&lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;self&gt; &amp; $source</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}-&gt; as $request;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$request.setAttribute(,,* as $res)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li><code>&lt;javaUnescapeOutput&gt;</code> - 发现未转义的输出点</li>
<li><code>request?{opcode:param ...}</code> - 识别Servlet请求参数</li>
<li><code>#{include:...}-&gt;</code> - 数据流分析，追踪从请求到输出的传播</li>
<li>检测完整的XSS攻击链</li>
</ul>
<p><strong>3. Spring Boot模板XSS检测</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;javaUnescapeOutput&gt; as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>在Spring Boot环境中检测Thymeleaf、JSP等模板的未转义输出</li>
<li>自动识别模板语法中的安全问题</li>
</ul>
<p><strong>4. 复杂JSP输出检测</strong></p>
<p>JSP代码：</p>
<div class="language-jsp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;table border=1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArrayList&lt;Message&gt; all = (ArrayList) session.getAttribute(&quot;all_messages&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (all != null) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Iterator it = all.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            while (it.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Message ms = (Message) it.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    %&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;td&gt;&lt;%= ms.getUsername() %&gt;&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;td&gt;&lt;%= ms.getTitle() %&gt;&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;td&gt;&lt;%= ms.getMessage() %&gt;&lt;/td&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/tr&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;% } } %&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/table&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;javaUnescapeOutput&gt; as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>识别JSP中的 <code>&lt;%= ... %&gt;</code> 输出表达式</li>
<li>检测 getUsername()、getTitle()、getMessage() 等方法的未转义输出</li>
<li>用于发现可能的存储型XSS漏洞</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="issanitizename">isSanitizeName<a href="#issanitizename" class="hash-link" aria-label="Direct link to isSanitizeName" title="Direct link to isSanitizeName">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-37">作用<a href="#作用-37" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>检查函数名是否为潜在的输入过滤/净化函数，用于识别安全相关的处理函数。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-42">示例<a href="#示例-42" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. 基本过滤函数识别</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 检查是否为过滤函数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sanitizeInput&lt;isSanitizeName&gt; as $sanitize;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">htmlEscape&lt;isSanitizeName&gt; as $escape;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">validateUser&lt;isSanitizeName&gt; as $validate;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>检查函数名是否包含sanitize、escape、validate等关键词</li>
<li>用于识别可能的输入净化处理函数</li>
<li>帮助分析数据流中的安全控制点</li>
</ul>
<p><strong>2. 安全分析中的应用</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">userInput #-&gt; * ?{&lt;isSanitizeName&gt;} as $secureProcessing;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">userInput #-&gt; * ?{!&lt;isSanitizeName&gt;} as $unsecureFlow;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>追踪用户输入的数据流</li>
<li>区分经过安全处理和未经过安全处理的路径</li>
<li>用于发现潜在的安全漏洞</li>
</ul>
<p><strong>3. 常见过滤函数模式</strong></p>
<p>常见的会被识别为过滤函数的名称模式：</p>
<ul>
<li>包含 &quot;sanitize&quot;, &quot;escape&quot;, &quot;encode&quot;, &quot;filter&quot;</li>
<li>包含 &quot;validate&quot;, &quot;clean&quot;, &quot;purify&quot;, &quot;safe&quot;</li>
<li>包含 &quot;normalize&quot;, &quot;strip&quot;, &quot;remove&quot;</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mybatissink">mybatisSink<a href="#mybatissink" class="hash-link" aria-label="Direct link to mybatisSink" title="Direct link to mybatisSink">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="作用-38">作用<a href="#作用-38" class="hash-link" aria-label="Direct link to 作用" title="Direct link to 作用">​</a></h4>
<p>专门用于查找MyBatis框架中的SQL注入sink点，自动识别MyBatis映射文件和注解中的危险SQL操作。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="示例-43">示例<a href="#示例-43" class="hash-link" aria-label="Direct link to 示例" title="Direct link to 示例">​</a></h4>
<p><strong>1. MyBatis注解SQL注入检测</strong></p>
<p>Java代码：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@Mapper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public interface UserMapper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Select(&quot;SELECT * FROM users WHERE name = &#x27;${name}&#x27;&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User findByName(@Param(&quot;name&quot;) String name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Update(&quot;UPDATE users SET email = &#x27;${email}&#x27; WHERE id = #{id}&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int updateEmail(@Param(&quot;id&quot;) Long id, @Param(&quot;email&quot;) String email);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;mybatisSink&gt; as $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>自动识别MyBatis注解中的 <code>${}</code> 占位符</li>
<li>检测可能的SQL注入风险点</li>
<li>区分安全的 <code>#{}</code> 和危险的 <code>${}</code></li>
</ul>
<p><strong>2. 与数据流分析结合</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;mybatisSink&gt; as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">request.getParameter(* as $userInput);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink #{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    include: &lt;&lt;&lt;EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;self&gt; &amp; $userInput</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}-&gt; as $dangerous;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>查找MyBatis的危险sink点</li>
<li>追踪用户输入到SQL注入点的数据流</li>
<li>检测完整的SQL注入攻击链</li>
</ul>
<p><strong>3. 批量MyBatis安全检查</strong></p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;mybatisSink&gt; as $allSinks;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$allSinks?{&lt;regexp(`\$\{.*\}`)&gt;} as $directInjection;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$allSinks?{!&lt;regexp(`#\{.*\}`)&gt;} as $noParamBinding;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>注释：</p>
<ul>
<li>查找所有MyBatis sink点</li>
<li>筛选直接字符串插值的危险用法</li>
<li>识别缺少参数绑定的SQL语句</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="Direct link to 总结" title="Direct link to 总结">​</a></h2>
<p>SyntaxFlow 的 NativeCall 机制提供了丰富的内置函数，使得用户可以更方便地实现复杂的代码分析功能。通过合理使用这些 NativeCall，可以大大提高规则编写的效率和准确性。</p>
<p>在使用 NativeCall 时，需要注意：</p>
<ol>
<li><strong>参数传递</strong>：大多数 NativeCall 支持参数传递，可以通过 <code>key=value</code> 的形式传递参数</li>
<li><strong>返回值处理</strong>：NativeCall 的返回值通常需要通过 <code>as</code> 关键字存储到变量中</li>
<li><strong>链式调用</strong>：多个 NativeCall 可以链式调用，形成复杂的分析逻辑</li>
<li><strong>错误处理</strong>：某些 NativeCall 在找不到匹配项时会返回空结果，需要适当处理</li>
</ol>
<p>通过熟练掌握这些 NativeCall，你可以构建出强大而灵活的代码分析规则。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/yaklang/ssa.to/tree/main/syntaxflow-guide/syntaxflow-guide/nativecall-demos.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-07-10T09:33:49.000Z" itemprop="dateModified">Jul 10, 2025</time></b> by <b>intSheep</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/syntaxflow-guide/statements/sf_file_filter"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">11. 文件过滤：检测文件内容</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">数据流敏感的代码漏洞检测</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么是-nativecall" class="table-of-contents__link toc-highlight">什么是 NativeCall？</a></li><li><a href="#常用-nativecall-详解" class="table-of-contents__link toc-highlight">常用 NativeCall 详解</a><ul><li><a href="#include" class="table-of-contents__link toc-highlight">include</a></li><li><a href="#typename" class="table-of-contents__link toc-highlight">typeName</a></li><li><a href="#fulltypename" class="table-of-contents__link toc-highlight">fullTypeName</a></li><li><a href="#getreturns" class="table-of-contents__link toc-highlight">getReturns</a></li><li><a href="#getformalparams" class="table-of-contents__link toc-highlight">getFormalParams</a></li><li><a href="#getfunc" class="table-of-contents__link toc-highlight">getFunc</a></li><li><a href="#getcall" class="table-of-contents__link toc-highlight">getCall</a></li><li><a href="#getcallee" class="table-of-contents__link toc-highlight">getCallee</a></li><li><a href="#searchfunc" class="table-of-contents__link toc-highlight">searchFunc</a></li><li><a href="#getobject" class="table-of-contents__link toc-highlight">getObject</a></li><li><a href="#getmembers" class="table-of-contents__link toc-highlight">getMembers</a></li><li><a href="#getmemberbykey" class="table-of-contents__link toc-highlight">getMemberByKey</a></li><li><a href="#getsiblings" class="table-of-contents__link toc-highlight">getSiblings</a></li><li><a href="#name" class="table-of-contents__link toc-highlight">name</a></li><li><a href="#string" class="table-of-contents__link toc-highlight">string</a></li><li><a href="#eval" class="table-of-contents__link toc-highlight">eval</a></li><li><a href="#fuzztag" class="table-of-contents__link toc-highlight">fuzztag</a></li><li><a href="#show" class="table-of-contents__link toc-highlight">show</a></li><li><a href="#slice" class="table-of-contents__link toc-highlight">slice</a></li><li><a href="#regexp" class="table-of-contents__link toc-highlight">regexp</a></li><li><a href="#strlower" class="table-of-contents__link toc-highlight">strlower</a></li><li><a href="#strupper" class="table-of-contents__link toc-highlight">strupper</a></li><li><a href="#var" class="table-of-contents__link toc-highlight">var</a></li><li><a href="#opcodes" class="table-of-contents__link toc-highlight">opcodes</a></li><li><a href="#sourcecode" class="table-of-contents__link toc-highlight">sourceCode</a></li><li><a href="#scannext" class="table-of-contents__link toc-highlight">scanNext</a></li><li><a href="#scanprevious" class="table-of-contents__link toc-highlight">scanPrevious</a></li><li><a href="#scaninstruction" class="table-of-contents__link toc-highlight">scanInstruction</a></li><li><a href="#const" class="table-of-contents__link toc-highlight">const</a></li><li><a href="#versionin" class="table-of-contents__link toc-highlight">versionIn</a></li><li><a href="#dataflow" class="table-of-contents__link toc-highlight">dataflow</a></li><li><a href="#self" class="table-of-contents__link toc-highlight">self</a></li><li><a href="#forbid" class="table-of-contents__link toc-highlight">forbid</a></li><li><a href="#delete" class="table-of-contents__link toc-highlight">delete</a></li><li><a href="#getusers" class="table-of-contents__link toc-highlight">getUsers</a></li><li><a href="#getpredecessors" class="table-of-contents__link toc-highlight">getPredecessors</a></li><li><a href="#getactualparams" class="table-of-contents__link toc-highlight">getActualParams</a></li><li><a href="#getactualparamlen" class="table-of-contents__link toc-highlight">getActualParamLen</a></li><li><a href="#getcurrentblueprint" class="table-of-contents__link toc-highlight">getCurrentBlueprint</a></li><li><a href="#getblueprint" class="table-of-contents__link toc-highlight">getBluePrint</a></li><li><a href="#getparentsblueprint" class="table-of-contents__link toc-highlight">getParentsBlueprint</a></li><li><a href="#getinterfaceblueprint" class="table-of-contents__link toc-highlight">getInterfaceBlueprint</a></li><li><a href="#getrootparentblueprint" class="table-of-contents__link toc-highlight">getRootParentBlueprint</a></li><li><a href="#extendsby" class="table-of-contents__link toc-highlight">extendsBy</a></li><li><a href="#len" class="table-of-contents__link toc-highlight">len</a></li><li><a href="#root" class="table-of-contents__link toc-highlight">root</a></li><li><a href="#filenamebycontent" class="table-of-contents__link toc-highlight">FilenameByContent</a></li><li><a href="#getfullfilename" class="table-of-contents__link toc-highlight">getFullFileName</a></li><li><a href="#foreach_function_inst" class="table-of-contents__link toc-highlight">foreach_function_inst</a></li><li><a href="#javaunescapeoutput" class="table-of-contents__link toc-highlight">javaUnescapeOutput</a></li><li><a href="#issanitizename" class="table-of-contents__link toc-highlight">isSanitizeName</a></li><li><a href="#mybatissink" class="table-of-contents__link toc-highlight">mybatisSink</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer_jryj"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/community#%E5%BE%AE%E4%BF%A1%E4%BA%A4%E6%B5%81%E7%BE%A4">Wechat</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"></div></div><div class="footer__copyright copyright_C_OK">Copyright © 2025 ssa.to, Powered by yaklang.io</div></footer></div>
</body>
</html>