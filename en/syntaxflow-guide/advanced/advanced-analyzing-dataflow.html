<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-syntaxflow-guide docs-version-current docs-doc-page docs-doc-id-advanced/advanced-analyzing-dataflow" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">数据流敏感的代码漏洞检测 | SSA.to</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ssa.to/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" property="og:title" content="数据流敏感的代码漏洞检测 | SSA.to"><meta data-rh="true" name="description" content="当读者读完前置的内容，已经基本对 SyntaxFlow 的使用风格有了入门印象了，SyntaxFlow 实际上是一个非常具有深度的技术，我们将在本章节为大家讲解 SyntaxFlow 的高级用法和高级特性，以便帮助用户解决非常难的技术问题。"><meta data-rh="true" property="og:description" content="当读者读完前置的内容，已经基本对 SyntaxFlow 的使用风格有了入门印象了，SyntaxFlow 实际上是一个非常具有深度的技术，我们将在本章节为大家讲解 SyntaxFlow 的高级用法和高级特性，以便帮助用户解决非常难的技术问题。"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ssa.to/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/advanced/advanced-analyzing-dataflow" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ssa.to/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow" hreflang="en"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/advanced/advanced-analyzing-dataflow" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.cd8d0c84.css">
<script src="/en/assets/js/runtime~main.4002294a.js" defer="defer"></script>
<script src="/en/assets/js/main.ebd69a15.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo-dark.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SSA.to</b></a><a class="navbar__item navbar__link" href="/en/static-analysis-guide/intro">静态代码分析教程</a><a class="navbar__item navbar__link" href="/en/docs/intro">代码扫描基础使用</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/syntaxflow-guide/intro">SyntaxFlow 文档</a><a class="navbar__item navbar__link" href="/en/cookbook">SyntaxFlow 手册离线 PDF</a><a class="navbar__item navbar__link" href="/en/codeAnalysis">Code Analysis NOW!</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/syntaxflow-guide/advanced/advanced-analyzing-dataflow" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">中文</a></li><li><a href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbarSearchContainer_dCNk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/intro">SyntaxFlow 简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/quick-start">SyntaxFlow 快速入门指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/rule-intro">SyntaxFlow 规则文件介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/en/syntaxflow-guide/rule-intro">编写基础的 SyntaxFlow 规则</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/rule-intro">SytanxFlow 规则介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/intro-and-desc">desc 语句：准备并编写基础描述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-search">搜索定位：搜索符号或方法名</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-func-call">函数调用：审计调用和参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-variable">变量：存储和追踪审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dot-call-chain">链式调用：递归检查成员和调用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dataflow">数据流运算：追踪定义和使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-filter">过滤器：?{...} 筛选审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-calc">集合运算：交集 &amp;，差集 -，并集 +</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-nativecall">原生扩展：重要的 NativeCall 机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-sca">SCA: 依赖版本信息检测</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow">高级静态代码分析实战</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/syntaxflow-guide/advanced/advanced-analyzing-dataflow">数据流敏感的代码漏洞检测</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">高级静态代码分析实战</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">数据流敏感的代码漏洞检测</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>数据流敏感的代码漏洞检测</h1></header>
<p>当读者读完前置的内容，已经基本对 SyntaxFlow 的使用风格有了入门印象了，SyntaxFlow 实际上是一个非常具有深度的技术，我们将在本章节为大家讲解 SyntaxFlow 的高级用法和高级特性，以便帮助用户解决非常难的技术问题。</p>
<!-- -->
<div class="tableOfContentsInline_prmo"><ul class="table-of-contents"><li><a href="#什么是数据流路径敏感分析">什么是数据流路径敏感分析？</a><ul><li><a href="#定义">定义</a></li><li><a href="#数据流方向自顶向下和自底向上">数据流方向：自顶向下和自底向上</a></li><li><a href="#形式化表述">形式化表述</a></li></ul></li><li><a href="#开始实战syntaxflow-数据流分析">开始实战：SyntaxFlow 数据流分析</a><ul><li><a href="#1-生成数据流">1. 生成数据流</a></li><li><a href="#2-编写过滤语句">2. 编写过滤语句</a></li><li><a href="#3-规则解释与总结">3. 规则解释与总结</a></li></ul></li><li><a href="#nativecall-dataflow-的详细解释">NativeCall <code>&lt;dataflow&gt;</code> 的详细解释</a><ul><li><a href="#实例代码解释">实例代码解释</a></li><li><a href="#code-与-code-语法heredoc"><code>&lt;&lt;&lt;CODE</code> 与 <code>CODE</code> 语法：Heredoc</a></li><li><a href="#__next__-变量的作用"><code>$__next__</code> 变量的作用</a></li></ul></li></ul></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是数据流路径敏感分析">什么是数据流路径敏感分析？<a href="#什么是数据流路径敏感分析" class="hash-link" aria-label="Direct link to 什么是数据流路径敏感分析？" title="Direct link to 什么是数据流路径敏感分析？">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>简要背景</div><div class="admonitionContent_BuS1"><p>在静态代码分析领域，我们经常遇到一系列复杂的概念，如指针敏感性（pointer sensitivity）、数据流敏感性（data flow sensitivity）和路径敏感性（path sensitivity）等。大多数相关文献充斥着晦涩难懂的数学公式和LaTeX算法，这些表述方式往往给人以高深莫测的印象。令人遗憾的是，这些所谓的&quot;高级技术&quot;在实际工程实践和漏洞挖掘中的应用效果往往难以体现。更有甚者，相关的实现代码常常被刻意或无意地隐藏在文献的角落，使得这些技术与实际应用之间产生了巨大的鸿沟。</p><p>过分依赖理论推导和数学模型，而忽视了实际应用的重要性。这种做法不仅使得相关知识难以被广大工程师所理解和应用，更是阻碍了整个领域的发展。我们需要的是更加实用、直观、易于理解的教学和研究方法。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="定义">定义<a href="#定义" class="hash-link" aria-label="Direct link to 定义" title="Direct link to 定义">​</a></h3>
<p>在程序分析领域中，数据流分析（Data Flow Analysis）是一种静态分析技术，用于收集程序中数据在执行过程中如何流动和变化的信息。我们需要理解几个核心概念：</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>核心概念</div><div class="admonitionContent_BuS1"><ol>
<li><strong>数据流（Data Flow）</strong>：描述数据在程序中的传播路径和变化过程</li>
<li><strong>控制流（Control Flow）</strong>：描述程序执行的可能路径</li>
<li><strong>路径敏感性（Path Sensitivity）</strong>：分析时是否考虑程序的条件分支</li>
</ol></div></div>
<p>数据流分析通常涉及以下要素：</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据流方向自顶向下和自底向上">数据流方向：自顶向下和自底向上<a href="#数据流方向自顶向下和自底向上" class="hash-link" aria-label="Direct link to 数据流方向：自顶向下和自底向上" title="Direct link to 数据流方向：自顶向下和自底向上">​</a></h3>
<p>在进行数据流方向讨论的时候，我们考虑如下代码，可以加速用户理解这两个概念：</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $llink=trim($_GET[&#x27;query&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $query = &quot;SELECT * FROM nav WHERE link=&#x27;$llink&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result = mysql_query($query) or die(&#x27;SQL语句有误：&#x27;.mysql_error());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $navs = mysql_fetch_array($result);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们下面的案例多数基于这一段 PHP 代码进行讨论</p>
<p>数据流分析可以从两个方向进行，每种方向都有其特定的应用场景和优势：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-自顶向下top-down">1. 自顶向下（Top-Down）<a href="#1-自顶向下top-down" class="hash-link" aria-label="Direct link to 1. 自顶向下（Top-Down）" title="Direct link to 1. 自顶向下（Top-Down）">​</a></h4>
<!-- -->
<p><strong>特点：</strong></p>
<ul>
<li>从数据源开始追踪</li>
<li>适合发现数据污染范围</li>
<li>可以识别多个受影响的汇点</li>
<li>计算开销较大</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>应用场景</div><div class="admonitionContent_BuS1"><ol>
<li>污点分析（Taint Analysis）</li>
<li>变量影响范围分析</li>
<li>数据依赖分析</li>
</ol></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-自底向上bottom-up">2. 自底向上（Bottom-Up）<a href="#2-自底向上bottom-up" class="hash-link" aria-label="Direct link to 2. 自底向上（Bottom-Up）" title="Direct link to 2. 自底向上（Bottom-Up）">​</a></h4>
<!-- -->
<p><strong>特点：</strong></p>
<ul>
<li>从敏感操作点开始反向追踪</li>
<li>直接定位潜在问题</li>
<li>分析效率较高</li>
<li>适合特定漏洞检测</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>优势</div><div class="admonitionContent_BuS1"><ol>
<li>更快地定位潜在漏洞</li>
<li>减少不必要的路径分析</li>
<li>聚焦于特定安全问题</li>
</ol></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="比较分析">比较分析<a href="#比较分析" class="hash-link" aria-label="Direct link to 比较分析" title="Direct link to 比较分析">​</a></h4>
<table><thead><tr><th>特性</th><th>自顶向下</th><th>自底向上</th></tr></thead><tbody><tr><td>起点</td><td>数据源（Source）</td><td>数据汇（Sink）</td></tr><tr><td>分析范围</td><td>全面</td><td>针对性强</td></tr><tr><td>性能</td><td>较慢</td><td>较快</td></tr><tr><td>适用场景</td><td>全局数据流分析</td><td>特定漏洞检测</td></tr><tr><td>资源消耗</td><td>较高</td><td>较低</td></tr></tbody></table>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意事项</div><div class="admonitionContent_BuS1"><ol>
<li>选择合适的分析方向要考虑具体的应用场景</li>
<li>两种方向可以结合使用以获得更好的分析效果</li>
<li>需要权衡分析精度和性能开销</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="形式化表述">形式化表述<a href="#形式化表述" class="hash-link" aria-label="Direct link to 形式化表述" title="Direct link to 形式化表述">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-自顶向下分析 的形式化定义">1. 自顶向下分析的形式化定义<a href="#1-自顶向下分析的形式化定义" class="hash-link" aria-label="Direct link to 1. 自顶向下分析的形式化定义" title="Direct link to 1. 自顶向下分析的形式化定义">​</a></h4>
<p>在自顶向下分析中，我们从源点开始追踪数据流向所有可能的汇点。形式化定义如下：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>其中数据流传播函数可以定义为：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-自底向上分析的形式化定义">2. 自底向上分析的形式化定义<a href="#2-自底向上分析的形式化定义" class="hash-link" aria-label="Direct link to 2. 自底向上分析的形式化定义" title="Direct link to 2. 自底向上分析的形式化定义">​</a></h4>
<!-- -->
<p>自底向上分析从汇点开始反向追踪到可能的源点。形式化定义如下：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>反向传播函数定义为：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-路径敏感性分析">3. 路径敏感性分析<a href="#3-路径敏感性分析" class="hash-link" aria-label="Direct link to 3. 路径敏感性分析" title="Direct link to 3. 路径敏感性 分析">​</a></h4>
<p>在考虑路径敏感性时，我们需要引入路径条件：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>形式化说明</div><div class="admonitionContent_BuS1"><ul>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 节点n生成的数据流信息</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 节点n终止的数据流信息</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 节点n的前驱节点集合</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 节点n的后继节点集合</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 反向分析中节点n生成的数据流信息</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>: 反向分析中节点n终止的数据流信息</li>
</ul></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>实践注意</div><div class="admonitionContent_BuS1"><p>虽然形式化定义看起来复杂，但在实际实现中，我们通常会根据具体场景进行简化和优化。关键是要理解核心概念和传播规则。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="开始实战syntaxflow-数据流分析">开始实战：SyntaxFlow 数据流分析<a href="#开始实战syntaxflow-数据流分析" class="hash-link" aria-label="Direct link to 开始实战：SyntaxFlow 数据流分析" title="Direct link to 开始实战：SyntaxFlow 数据流分析">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-生成数据流">1. 生成数据流<a href="#1-生成数据流" class="hash-link" aria-label="Direct link to 1. 生成数据流" title="Direct link to 1. 生成数据流">​</a></h3>
<p>还是考虑上面的那一段代码：</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $llink=mysqli_real_escape_string(trim($_GET[&#x27;query&#x27;]));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $query = &quot;SELECT * FROM nav WHERE link=&#x27;$llink&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result = mysql_query($query) or die(&#x27;SQL语句有误：&#x27;.mysql_error());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $navs = mysql_fetch_array($result);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>保存为 <code>code.php</code> 之后，执行 <code>yak ssa -l php -t . -p dataflow</code> 命令进行编译，编译后我们就可以对 <code>dataflow</code> 这个程序名对应的程序进行测试并且，编写 SyntaxFlow 规则。在编译过程中会有日志输出，当你看到:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [language_parser:72] parsed file: [code.php]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [language_parser:77] program dataflow finish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [ssacli:189] finished compiling..., results: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [database_profile:26] SSA Database SaveIrCode Cost: 23.121462ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [database_profile:27] SSA Database SaveIndex Cost: 5.212542ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [database_profile:28] SSA Database SaveSourceCode Cost: 359.583µs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [database_profile:29] SSA Database SaveType Cost: 4.127001ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:43:54 [database_profile:30] SSA Database CacheToDatabase Cost: 23.195708ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之类的内容输出的时候意味着编译完成了。</p>
<p>随后创建扫描规则文件内容：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_GET.* as $params; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$params --&gt; * as $sink; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $sink;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>把上述规则保存为： <code>rule.sf</code> 然后再命令行中执行 <code>yak sf rule.sf -p dataflow</code> 将会看到输  出为：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:48:03 [ssacli:539] start to use SyntaxFlow rule: rule.sf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-09-26 13:48:03 [ssacli:688] syntax flow query result:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule md5 hash: 468a9fc888219cc95c0771b76b4ee88a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule preview: _GET.* as $params;  $params --&gt; * as $sink;  alert $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: {&quot;desc&quot;:&quot;&quot;,&quot;lang&quot;:&quot;&quot;,&quot;level&quot;:&quot;&quot;,&quot;title&quot;:&quot;&quot;,&quot;title_zh&quot;:&quot;&quot;,&quot;type&quot;:&quot;&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Result Vars: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  $sink:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t190614: eq(Undefined-mysql_query(add(add...ET.query(valid)))), &quot;&#x27;&quot;)), true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        code.php:4:5 - 4:67</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t190631: Undefined-mysql_fetch_array(Unde...ned-_GET.query(valid)))), &quot;&#x27;&quot;)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        code.php:5:13 - 5:39</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>看到上述数据，基本说明我们获取到了数据流的两个关键最终点，一个是 <code>mysql_fetch_array</code> 的调用结果，另一个是 <code>mysql_query</code> 执行结果和 <code>true</code> 的比较函数（这是由 <code>or</code> 运算来产生的，不要惊慌）。</p>
<p>我们在这里已经成功获取到了数据流最终终结的位置，在这里看他还是相当准确的，把上述结果整理起来就可以看到真正的结果所有数据流相关的结果：</p>
<!-- -->
<p>在途中我们可以很清楚的发现，最终的结果其实是 <code>eq</code> 和一个 <code>$navs</code> 变量。那么光得到这一步，我们还不能说可以过滤出想要的结果，那么如何在规则中编写过滤语句呢？</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>事实上，我们发现，mysqli_real_escape_string 这个函数存在的话，漏洞发生就会变的困难。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-编写过滤语句">2. 编写过滤语句<a href="#2-编写过滤语句" class="hash-link" aria-label="Direct link to 2. 编写过滤语句" title="Direct link to 2. 编写过滤语句">​</a></h3>
<p>我们经过上述操作可以得到数据流最终的点，但是需要检查过滤的步骤，这个时候应该怎么做呢？我们在 SyntaxFlow 中可以通过 <code>&lt;dataflow()&gt;</code> 这个功能来实现：</p>
<p>我们把这个复杂的数据流捋清的过程封装成了一个叫 <code>&lt;dataflow&gt;</code> 的 NativeCall。用户可以调用这个指令，把数据流的所有路径整理成在一起，一起进行检查，直到过滤出自己想要的数据。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>NativeCall 是什么？</div><div class="admonitionContent_BuS1"><p>如果用户对这个东西有点陌生，可以参考 “基础” 章节的内容。</p><p>NativeCall 是 SyntaxFlow 提供的一种机制，允许用户在规则中调用一些内置的函数，这些函数通常是一些复杂的操作，例如数据流分析、污点分析等。通过 NativeCall，用户可以更方便地实现一些高级的分析功能，而无需手动编写复杂的逻辑。</p></div></div>
<p>继续案例中 PHP 的程序规则：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_GET.* as $params; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$params --&gt; * as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink&lt;dataflow(&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: call &amp;&amp; &lt;getCaller&gt;&lt;name&gt;?{have: mysqli_real_escape_string }} as $__next__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt; as $filtered;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink - $filtered as $vuln;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $vuln;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这段审计代码看起来就复杂了不少，我们直接把这段代码执行一下： <code>yak sf -p dataflow rule.sf</code> 发现他无法输出原来的信息了，因为我们过滤了 <code>mysqli_real_escape_string</code> 这个函数。</p>
<p>我们基于之前的案例创建一个有漏洞的代码（删除一些函数）：</p>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $llink=trim($_GET[&#x27;query&#x27;]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $query = &quot;SELECT * FROM nav WHERE link=&#x27;$llink&#x27;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $result = mysql_query($query) or die(&#x27;SQL语句有误：&#x27;.mysql_error());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $navs = mysql_fetch_array($result);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在上述代码中移除了 mysqli_real_escape_string 函数，发现重新执行规则将会检查出来，那就发生了什么？接下来我们将解释一下这段代码究竟怎么回事儿：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="syntaxflow-检测-sql-注入的规则解释">SyntaxFlow 检测 SQL 注入的规则解释<a href="#syntaxflow-检测-sql-注入的规则解释" class="hash-link" aria-label="Direct link to SyntaxFlow 检测 SQL 注入的规则解释" title="Direct link to SyntaxFlow 检测 SQL 注入的规则解释">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="1-输入数据收集-_get-as-params">1. 输入数据收集 <code>_GET.* as $params;</code><a href="#1-输入数据收集-_get-as-params" class="hash-link" aria-label="Direct link to 1-输入数据收集-_get-as-params" title="Direct link to 1-输入数据收集-_get-as-params">​</a></h5>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>数据源获取</div><div class="admonitionContent_BuS1"><p>这行代码 从 PHP 的全局 <code>$_GET</code> 数组中获取所有参数，并将这些参数存储到变量 <code>$params</code> 中。这是对用户输入数据的初始收集阶段。</p></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2-数据流追踪-params-----as-sink">2. 数据流追踪 <code>$params --&gt; * as $sink;</code><a href="#2-数据流追踪-params-----as-sink" class="hash-link" aria-label="Direct link to 2-数据流追踪-params-----as-sink" title="Direct link to 2-数据流追踪-params-----as-sink">​</a></h5>
<p>这条指令建立了数据流追踪路径：</p>
<ul>
<li>从 <code>$params</code> 开始追踪数据流向</li>
<li><code>*</code> 表示追踪所有可能的目标位置</li>
<li>结果存储在 <code>$sink</code> 变量中，代表所有潜在的危险使用点</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3-过滤器定义和使用-sinkdataflow">3. 过滤器定义和使用 <code>$sink&lt;dataflow(...)&gt;...</code><a href="#3-过滤器定义和使用-sinkdataflow" class="hash-link" aria-label="Direct link to 3-过滤器定义和使用-sinkdataflow" title="Direct link to 3-过滤器定义和使用-sinkdataflow">​</a></h5>
<div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$sink&lt;dataflow(&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: call &amp;&amp; &lt;getCaller&gt;&lt;name&gt;?{have: mysqli_real_escape_string }} as $__next__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt; as $filtered;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>过滤器说明</div><div class="admonitionContent_BuS1"><p>这段代码定义了数据流分析的核心过滤逻辑：</p><ul>
<li>检测所有函数调用（<code>opcode: call</code>）</li>
<li>特别关注调用 <code>mysqli_real_escape_string</code> 的情况</li>
<li>将经过安全处理的数据点标记为 <code>$filtered</code></li>
</ul></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="4-移除黑名单路径-sink---filtered-as-vuln">4. 移除黑名单路径 <code>$sink - $filtered as $vuln</code><a href="#4-移除黑名单路径-sink---filtered-as-vuln" class="hash-link" aria-label="Direct link to 4-移除黑名单路径-sink---filtered-as-vuln" title="Direct link to 4-移除黑名单路径-sink---filtered-as-vuln">​</a></h5>
<p>这一步执行漏洞检测：</p>
<ul>
<li>从所有潜在危险点 (<code>$sink</code>) 中</li>
<li>移除已经过滤的数据点 (<code>$filtered</code>)</li>
<li>剩余的点即为潜在漏洞点 (<code>$vuln</code>)</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="5-警告生成-alert-vuln">5. 警告生成 <code>alert $vuln;</code><a href="#5-警告生成-alert-vuln" class="hash-link" aria-label="Direct link to 5-警告生成-alert-vuln" title="Direct link to 5-警告生成-alert-vuln">​</a></h5>
<p>最后一步是生成警告，报告所有发现的潜在漏洞点。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-规则解释与总结">3. 规则解释与总结<a href="#3-规则解释与总结" class="hash-link" aria-label="Direct link to 3. 规则解释与总结" title="Direct link to 3. 规则解释与总结">​</a></h3>
<!-- -->
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>最佳实践</div><div class="admonitionContent_BuS1"><p>在实际开发中，建议：</p><ol>
<li>对所有用户输入进行适当的过滤和转义</li>
<li>使用预处理语句而不是直接拼接 SQL</li>
<li>定期进行类似的静态代码分析</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nativecall-dataflow-的详细解释">NativeCall <code>&lt;dataflow&gt;</code> 的详细解释<a href="#nativecall-dataflow-的详细解释" class="hash-link" aria-label="Direct link to nativecall-dataflow-的详细解释" title="Direct link to nativecall-dataflow-的详细解释">​</a></h2>
<p><code>&lt;dataflow&gt;</code> 是一个高级的 NativeCall 函数，用于在代码中进行数据流分析。它的参数是一段专门用于检查特定变量的数据流路径的代码。这段代码帮助  识别和过滤数据流路径，从而发现潜在的安全漏洞。为了确保分析的准确性，进入 <code>&lt;dataflow&gt;</code> 的变量必须至少经过 Use-Def 运算符的处理，这样可以确保变量的来源和使用都被妥善追踪和记录。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实例代码解释">实例代码解释<a href="#实例代码解释" class="hash-link" aria-label="Direct link to 实例代码解释" title="Direct link to 实例代码解释">​</a></h3>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">_GET.* as $params;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$params --&gt; * as $sink;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink&lt;dataflow(&lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*?{opcode: call &amp;&amp; &lt;getCaller&gt;&lt;name&gt;?{have: mysqli_real_escape_string }} as $__next__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE)&gt; as $filtered;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sink - $filtered as $vuln;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $vuln;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="code-与-code-语法heredoc"><code>&lt;&lt;&lt;CODE</code> 与 <code>CODE</code> 语法：Heredoc<a href="#code-与-code-语法heredoc" class="hash-link" aria-label="Direct link to code-与-code-语法heredoc" title="Direct link to code-与-code-语法heredoc">​</a></h3>
<p><code>&lt;&lt;&lt;CODE</code> 到 <code>CODE</code> 的语法类似于 PHP 中的 <code>HereDoc</code> 语法。它用于定义一个多行的字符串或代码块，在 <code>&lt;dataflow&gt;</code> 的上下文中，这种语法用于编写复杂的查询逻辑。<code>&lt;&lt;&lt;CODE</code> 标记代码块的开始，而 <code>CODE</code> 标记代码块的结束。这允许开发者在 NativeCall 函数中嵌入较长或较复杂的代码片段。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Heredoc 简介</div><div class="admonitionContent_BuS1"><p>Heredoc 是一种在多种编程语言中都存在的字符串定义语法，允许开发者以一种清晰、直观的方式处理多行文本。它的特点是保留文本的原始格式，包括换行和空格。</p><p><strong>PHP 中的 Heredoc</strong></p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$heredoc = &lt;&lt;&lt;CODE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;h1&gt;Hello, World!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODE;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>特性</p><ul>
<li>使用 <code>&lt;&lt;&lt;</code> 后跟标识符（  如上例中的 <code>SQL</code>）开始</li>
<li>结束标识符必须独占一行</li>
<li>结束标识符前不能有任何空格</li>
<li>支持变量解析（默认情况下）</li>
<li>可以用于类的属性默认值</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="__next__-变量的作用"><code>$__next__</code> 变量的作用<a href="#__next__-变量的作用" class="hash-link" aria-label="Direct link to __next__-变量的作用" title="Direct link to __next__-变量的作用">​</a></h3>
<p>在 <code>&lt;&lt;&lt;CODE</code> 块中定义的查询逻辑中，<code>$__next__</code> 是一个特殊的变量，用于存储满足查询条件的代码点。在上述示例中，任何调用 <code>mysqli_real_escape_string</code> 函数的地方都会被捕获并赋值给 <code>$__next__</code>。如果 <code>$__next__</code> 不为空，即存在至少一个满足条件的点，那么当前路径对应的点将会被保留。这种机制允许 <code>&lt;dataflow&gt;</code> 分析函数细致地筛选和确定哪些数据流路径是安全的，哪些可能包含潜在的安全风险。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/yaklang/ssa.to/tree/main/syntaxflow-guide/syntaxflow-guide/advanced/advanced-analyzing-dataflow.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-11-28T09:48:36.000Z" itemprop="dateModified">Nov 28, 2024</time></b> by <b>v1ll4n</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/syntaxflow-guide/statements/sf-sca"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SCA: 依赖版本信息检测</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#什么是数据流路径敏感分析" class="table-of-contents__link toc-highlight">什么是数据流路径敏感分析？</a><ul><li><a href="#定义" class="table-of-contents__link toc-highlight">定义</a></li><li><a href="#数据流方向自顶向下和自底向上" class="table-of-contents__link toc-highlight">数据流方向：自顶向下和自底向上</a></li><li><a href="#形式化表述" class="table-of-contents__link toc-highlight">形式化表述</a></li></ul></li><li><a href="#开始实战syntaxflow-数据流分析" class="table-of-contents__link toc-highlight">开始实战：SyntaxFlow 数据流分析</a><ul><li><a href="#1-生成数据流" class="table-of-contents__link toc-highlight">1. 生成数据流</a></li><li><a href="#2-编写过滤语句" class="table-of-contents__link toc-highlight">2. 编写过滤语句</a></li><li><a href="#3-规则解释与总结" class="table-of-contents__link toc-highlight">3. 规则解释与总结</a></li></ul></li><li><a href="#nativecall-dataflow-的详细解释" class="table-of-contents__link toc-highlight">NativeCall <code>&lt;dataflow&gt;</code> 的详细解释</a><ul><li><a href="#实例代码解释" class="table-of-contents__link toc-highlight">实例代码解释</a></li><li><a href="#code-与-code-语法heredoc" class="table-of-contents__link toc-highlight"><code>&lt;&lt;&lt;CODE</code> 与 <code>CODE</code> 语法：Heredoc</a></li><li><a href="#__next__-变量的作用" class="table-of-contents__link toc-highlight"><code>$__next__</code> 变量的作用</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer_jryj"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/community#%E5%BE%AE%E4%BF%A1%E4%BA%A4%E6%B5%81%E7%BE%A4">Wechat</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"></div></div><div class="footer__copyright copyright_C_OK">Copyright © 2024 ssa.to, Powered by yaklang.io</div></footer></div>
</body>
</html>