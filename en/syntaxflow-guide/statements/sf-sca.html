<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-syntaxflow-guide docs-version-current docs-doc-page docs-doc-id-statements/sf-sca" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">SCA: 依赖版本信息检测 | SSA.to</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ssa.to/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ssa.to/en/syntaxflow-guide/statements/sf-sca"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-syntaxflow-guide-current"><meta data-rh="true" property="og:title" content="SCA: 依赖版本信息检测 | SSA.to"><meta data-rh="true" name="description" content="SyntaxFlow 能够解析依赖包的版本信息，同时也允许用户编写规则来分析这些版本信息。通过对依赖版本的检测，可以有效识别项目中存在已知漏洞的依赖包，从而提升代码的安全性和稳定性。本节将详细介绍如何在 SyntaxFlow 中获取和筛选依赖版本信息，并通过实例演示如何检测具有漏洞的依赖包版本。"><meta data-rh="true" property="og:description" content="SyntaxFlow 能够解析依赖包的版本信息，同时也允许用户编写规则来分析这些版本信息。通过对依赖版本的检测，可以有效识别项目中存在已知漏洞的依赖包，从而提升代码的安全性和稳定性。本节将详细介绍如何在 SyntaxFlow 中获取和筛选依赖版本信息，并通过实例演示如何检测具有漏洞的依赖包版本。"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ssa.to/en/syntaxflow-guide/statements/sf-sca"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/statements/sf-sca" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ssa.to/en/syntaxflow-guide/statements/sf-sca" hreflang="en"><link data-rh="true" rel="alternate" href="https://ssa.to/syntaxflow-guide/statements/sf-sca" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.bdb0bf75.css">
<script src="/en/assets/js/runtime~main.c1e18c28.js" defer="defer"></script>
<script src="/en/assets/js/main.42ecb919.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/logo-dark.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SSA.to</b></a><a class="navbar__item navbar__link" href="/en/docs/intro">代码扫描基础使用</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/syntaxflow-guide/intro">SyntaxFlow 文档</a><a class="navbar__item navbar__link" href="/en/cookbook">SyntaxFlow 手册离线 PDF</a><a class="navbar__item navbar__link" href="/en/codeAnalysis">Code Analysis NOW!</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/syntaxflow-guide/statements/sf-sca" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh">中文</a></li><li><a href="/en/syntaxflow-guide/statements/sf-sca" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><div class="navbarSearchContainer_dCNk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/intro">SyntaxFlow 简介</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/quick-start">SyntaxFlow 快速入门指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/syntaxflow-guide/rule-intro">SyntaxFlow 规则文件介绍</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/en/syntaxflow-guide/rule-intro">编写基础的 SyntaxFlow 规则</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/rule-intro">SytanxFlow 规则介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/intro-and-desc">desc 语句：准备并编写基础描述</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-search">搜索定位：搜索符号或方法名</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-func-call">函数调用：审计调用和参数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-variable">变量：存储和追踪审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dot-call-chain">链式调用：递归检查成员和调用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-dataflow">数据流运算：追踪定义和使用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-filter">过滤器：?{...} 筛选审计结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-calc">集合运算：交集 &amp;，差集 -，并集 +</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/syntaxflow-guide/statements/sf-nativecall">原生扩展：重要的 NativeCall 机制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/syntaxflow-guide/statements/sf-sca">SCA: 依赖版本信息检测</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">编写基础的 SyntaxFlow 规则</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SCA: 依赖版本信息检测</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SCA: 依赖版本信息检测</h1></header>
<p><strong>SyntaxFlow</strong> 能够解析依赖包的版本信息，同时也允许用户编写规则来分析这些版本信息。通过对依赖版本的检测，可以有效识别项目中存在已知漏洞的依赖包，从而提升代码的安全性和稳定性。本节将详细介绍如何在 <strong>SyntaxFlow</strong> 中获取和筛选依赖版本信息，并通过实例演示如何检测具有漏洞的依赖包版本。</p>
<!-- -->
<div class="tableOfContentsInline_prmo"><ul class="table-of-contents"><li><a href="#简介">简介</a></li><li><a href="#获取依赖信息">获取依赖信息</a></li><li><a href="#筛选依赖版本">筛选依赖版本</a><ul><li><a href="#version_in-语法定义">version_in 语法定义</a></li><li><a href="#version_in-语法示例">version_in 语法示例</a></li></ul></li><li><a href="#实战案例分析具有漏洞版本的-fastjson">实战案例：分析具有漏洞版本的 fastjson</a><ul><li><a href="#依赖信息示例maven">依赖信息示例（Maven）</a></li><li><a href="#规则编写">规则编写</a></li><li><a href="#执行效果">执行效果</a></li></ul></li><li><a href="#实战中的注意事项">实战中的注意事项</a><ul><li><a href="#1-确保依赖信息的准确性">1. 确保依赖信息的准确性</a></li><li><a href="#2-版本区间的准确性">2. 版本区间的准确性</a></li><li><a href="#3-性能优化">3. 性能优化</a></li><li><a href="#4-定期更新漏洞信息">4. 定期更新漏洞信息</a></li></ul></li><li><a href="#最佳实践">最佳实践</a><ul><li><a href="#1-模块化编写规则">1. 模块化编写规则</a></li><li><a href="#2-结合自动化工具">2. 结合自动化工具</a></li><li><a href="#3-定期审查和更新规则">3. 定期审查和更新规则</a></li><li><a href="#4-使用详细的描述和修复建议">4. 使用详细的描述和修复建议</a></li><li><a href="#5-测试规则的有效性">5. 测试规则的有效性</a></li></ul></li><li><a href="#总结">总结</a></li></ul></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="简介">简介<a href="#简介" class="hash-link" aria-label="Direct link to 简介" title="Direct link to 简介">​</a></h2>
<p>在现代软件开发中，依赖管理是一个关键环节。项目通常依赖多个第三方库和框架，而这些依赖包的版本直接影响项目的安全性和稳定性。<strong>SyntaxFlow</strong> 提供了强大的功能来解析和分析依赖包的版本信息，使开发者能够轻松检测出存在已知漏洞的依赖版本，从而及时采取措施进行更新或替换。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="获取依赖信息">获取依赖信息<a href="#获取依赖信息" class="hash-link" aria-label="Direct link to 获取依赖信息" title="Direct link to 获取依赖信息">​</a></h2>
<p><strong>SyntaxFlow</strong> 通过内置变量 <code>__dependency__</code> 存储解析后的依赖信息。用户可以通过筛选依赖名称的方式获取特定依赖的版本信息或文件信息。以下是获取依赖信息的示例：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 获取依赖名以 fastjson 结尾的依赖版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__dependency__.*fastjson.version as $ver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取依赖名以 fastjson 结尾所在的依赖文件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__dependency__.*fastjson.filename as $file;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong><code>__dependency__.*fastjson.version as $ver;</code></strong>：筛选依赖名称以 <code>fastjson</code> 结尾的依赖版本，并将结果存储在变量 <code>$ver</code> 中。</li>
<li><strong><code>__dependency__.*fastjson.filename as $file;</code></strong>：筛选依赖名称以 <code>fastjson</code> 结尾的依赖文件，并将结果存储在变量 <code>$file</code> 中。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="筛选依赖版本">筛选依赖版本<a href="#筛选依赖版本" class="hash-link" aria-label="Direct link to 筛选依赖版本" title="Direct link to 筛选依赖版本">​</a></h2>
<p>获取到依赖的版本信息后，下一步通常是筛选出存在已知漏洞的版本。<strong>SyntaxFlow</strong> 提供了 <code>version_in</code> 语法来定义版本区间，以便检测依赖版本是否落在特定的漏洞版本范围内。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="version_in-语法定义">version_in 语法定义<a href="#version_in-语法定义" class="hash-link" aria-label="Direct link to version_in 语法定义" title="Direct link to version_in 语法定义">​</a></h3>
<p><strong>SyntaxFlow</strong> 中 <code>version_in</code> 的语法定义如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">filterItem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | In versionInExpression                     # VersionInFilter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionInExpression: versionInterval (&#x27;||&#x27; versionInterval)*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionInterval: ( &#x27;[&#x27; | &#x27;(&#x27;) vstart? &#x27;,&#x27; vend? (   &#x27;]&#x27;| &#x27;)&#x27; ) ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vstart: versionString;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vend: versionString;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// unless &#x27;,&#x27; &#x27;]&#x27; &#x27;)&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionBlockElement: Number versionSuffix* ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionSuffix: &#x27;-&#x27; | Identifier;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionBlock:  versionBlockElement (&#x27;.&#x27; versionBlockElement )*;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">versionString</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    : stringLiteral</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | versionBlock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">In: &#x27;in&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">conditionExpression</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |  VersionIn &#x27;:&#x27; versionInExpression              # VersionInCondition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VersionIn: &#x27;version_in&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong><code>version_in</code></strong>：关键字，用于表示版本区间筛选。</li>
<li><strong><code>versionInterval</code></strong>：定义一个版本区间，使用圆括号 <code>()</code> 表示不包括边界，方括号 <code>[]</code> 表示包括边界。多个区间可以用 <code>||</code> 连接，表示并集。</li>
<li><strong><code>versionString</code></strong>：版本字符串，可以是简单的字符串字面量或由数字和后缀组成的版本块。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="version_in-语法示例">version_in 语法示例<a href="#version_in-语法示例" class="hash-link" aria-label="Direct link to version_in 语法示例" title="Direct link to version_in 语法示例">​</a></h3>
<p>以下是 <code>version_in</code> 语法的使用示例：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 检查版本是否在 1 &lt; version &lt;= 2 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version in (1,2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 检查版本是否在 1.0.0 &lt; version &lt;= 2.0.0 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version in (1.0.0,2.0.0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 检查版本是否在 1.2.3-beta &lt; version &lt;= 2.2.1-beta 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version in (1.2.3-beta,2.2.1-beta]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 检查版本是否在 [1.1,1.3] 或 [2.2,2.3] 或 [3.2,3.3] 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version in [1.1,1.3] || [2.2,2.3] || [3.2,3.3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此外，也可以使用分析值筛选过滤的语法进行版本筛选：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$version ?{version_in:(1,2]} // 版本号是否在 1 &lt; version &lt;= 2 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version ?{version_in:(1.0.0,2.0.0]} // 版本号是否在 1.0.0 &lt; version &lt;= 2.0.0 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version ?{version_in:(1.2.3-beta,2.2.1-beta]} // 版本号是否在 1.2.3-beta &lt; version &lt;= 2.2.1-beta 范围内</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$version ?{version_in:[1.1,1.3] || [2.2,2.3] || [3.2,3.3]} // 版本号是否在多个范围内</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实战案例分析具有漏洞版本的-fastjson">实战案例：分析具有漏洞版本的 fastjson<a href="#实战案例分析具有漏洞版本的-fastjson" class="hash-link" aria-label="Direct link to 实战案例：分析具有漏洞版本的 fastjson" title="Direct link to 实战案例：分析具有漏洞版本的 fastjson">​</a></h2>
<p>以下将通过一个实际案例，演示如何使用 <strong>SyntaxFlow</strong> 检测项目中是否存在具有已知漏洞的 <code>fastjson</code> 版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="依赖信息示例maven">依赖信息示例（Maven）<a href="#依赖信息示例maven" class="hash-link" aria-label="Direct link to 依赖信息示例（Maven）" title="Direct link to 依赖信息示例（Maven）">​</a></h3>
<p>假设项目使用 Maven 进行依赖管理，以下是一个含有 <code>fastjson</code> 依赖的 <code>pom.xml</code> 文件示例：</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">project</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">xmlns</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xmlns:</span><span class="token tag attr-name" style="color:#00a4db">xsi</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://www.w3.org/2001/XMLSchema-instance</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">         </span><span class="token tag attr-name namespace" style="color:#00a4db;opacity:0.7">xsi:</span><span class="token tag attr-name" style="color:#00a4db">schemaLocation</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">http://maven.apache.org/POM/4.0.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token tag attr-value" style="color:#e3116c">                             http://maven.apache.org/xsd/maven-4.0.0.xsd</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">4.0.0</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">modelVersion</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.example</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">vulnerable-fastjson-app</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.0-SNAPSHOT</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Fastjson dependency with known vulnerabilities --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">fastjson</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- An example version with known vulnerabilities, make sure to check for specific vulnerable versions --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1.2.24</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependencies</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">project</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="规则编写">规则编写<a href="#规则编写" class="hash-link" aria-label="Direct link to 规则编写" title="Direct link to 规则编写">​</a></h3>
<p>基于上述依赖信息，编写 <strong>SyntaxFlow</strong> 规则以检测 <code>fastjson</code> 的版本是否存在已知漏洞。以下是具体的规则示例：</p>
<div class="language-syntaxflow codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-syntaxflow codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 定义规则描述</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">desc(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Title&quot;: &quot;检测存在漏洞的 fastjson 版本&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Description&quot;: &quot;识别项目中使用的 fastjson 版本是否在已知漏洞范围内。&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;Fix&quot;: &quot;升级 fastjson 到最新安全版本&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 获取依赖名以 fastjson 结尾的依赖版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__dependency__.*fastjson.version as $ver;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 筛选出存在漏洞的 fastjson 版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$vulnVersion = $ver ?{version_in:(1.2.3,2.3.4]};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 定义警告信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alert $vulnVersion for {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;title&quot;: &quot;存在 fastjson 1.2.3-2.3.4 版本漏洞&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;description&quot;: &quot;项目中使用的 fastjson 版本在 1.2.3 到 2.3.4 之间，存在已知漏洞，建议升级。&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;severity&quot;: &quot;High&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;fix&quot;: &quot;升级 fastjson 到最新安全版本。&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="规则解释">规则解释<a href="#规则解释" class="hash-link" aria-label="Direct link to 规则解释" title="Direct link to 规则解释">​</a></h4>
<ol>
<li><strong>描述信息</strong>：<!-- -->
<ul>
<li><strong><code>desc</code></strong>：定义规则的标题、描述和修复建议。</li>
</ul>
</li>
<li><strong>获取依赖版本</strong>：<!-- -->
<ul>
<li><strong><code>__dependency__.*fastjson.version as $ver;</code></strong>：筛选依赖名称以 <code>fastjson</code> 结尾的依赖版本，并将结果存储在 <code>$ver</code> 中。</li>
</ul>
</li>
<li><strong>筛选漏洞版本</strong>：<!-- -->
<ul>
<li><strong><code>$vulnVersion = $ver ?{version_in:(1.2.3,2.3.4]};</code></strong>：使用 <code>version_in</code> 语法，筛选出版本号在 <code>(1.2.3,2.3.4]</code> 范围内的 <code>fastjson</code> 版本。</li>
</ul>
</li>
<li><strong>定义警告</strong>：<!-- -->
<ul>
<li><strong><code>alert $vulnVersion for { ... };</code></strong>：针对筛选出的漏洞版本，定义警告信息，包括标题、描述、严重性等级以及修复建议。</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="执行效果">执行效果<a href="#执行效果" class="hash-link" aria-label="Direct link to 执行效果" title="Direct link to 执行效果">​</a></h3>
<p>保存上述规则为 <code>fastjson_vuln.sf</code>，并执行以下命令进行审计：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yak ssa -t . --program fastjson_app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yak sf --program fastjson_app fastjson_vuln.sf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>预期输出示例</strong>：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[INFO] 2024-07-10 14:20:30 [ssacli:272] syntax flow query result:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule md5 hash: f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rule preview: desc(    &quot;Title&quot;: &quot;检测存在漏洞的 fastjson 版本&quot;,...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">description: {Title: &quot;检测存在漏洞的 fastjson 版本&quot;, Description: &quot;识别项目中使用的 fastjson 版本是否在已知漏洞范围内。&quot;, Fix: &quot;升级 fastjson 到最新安全版本&quot;, $vulnVersion: &quot;存在 fastjson 1.2.3-2.3.4 版本漏洞&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Result Vars:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  vulnVersion:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t1329001: 1.2.24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pom.xml:17:20 - 17:27</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>结果解释</strong>：</p>
<ul>
<li><strong><code>$vulnVersion</code></strong>：检测到 <code>fastjson</code> 版本 <code>1.2.24</code> 落在 <code>(1.2.3,2.3.4]</code> 的漏洞范围内。</li>
<li><strong>警告信息</strong>：根据规则定义，输出存在漏洞的 <code>fastjson</code> 版本，并提供相应的修复建议。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实战中的注意事项">实战中的注意事项<a href="#实战中的注意事项" class="hash-link" aria-label="Direct link to 实战中的注意事项" title="Direct link to 实战中的注意事项">​</a></h2>
<p>在实际应用 <strong>SyntaxFlow</strong> 进行依赖版本信息检测时，需要注意以下几点：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-确保依赖信息的准确性">1. 确保依赖信息的准确性<a href="#1-确保依赖信息的准确性" class="hash-link" aria-label="Direct link to 1. 确保依赖信息的准确性" title="Direct link to 1. 确保依赖信息的准确性">​</a></h3>
<ul>
<li><strong>依赖格式</strong>：确保项目的依赖管理工具（如 Maven、Gradle）的配置文件格式正确，以便 <strong>SyntaxFlow</strong> 能够准确解析依赖信息。</li>
<li><strong>依赖名称匹配</strong>：在筛选依赖时，使用正确的名称匹配模式，避免因名称不匹配导致未能检测到目标依赖。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-版本区间的准确性">2. 版本区间的准确性<a href="#2-版本区间的准确性" class="hash-link" aria-label="Direct link to 2. 版本区间的准确性" title="Direct link to 2. 版本区间的准确性">​</a></h3>
<ul>
<li><strong>边界符号</strong>：圆括号 <code>()</code> 表示不包括边界，方括号 <code>[]</code> 表示包括边界。根据漏洞公告，准确设置版本区间的包含与否。</li>
<li><strong>多区间的使用</strong>：当漏洞影响多个不连续的版本区间时，使用 <code>||</code> 连接多个区间进行并集匹配。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-性能优化">3. 性能优化<a href="#3-性能优化" class="hash-link" aria-label="Direct link to 3. 性能优化" title="Direct link to 3. 性能优化">​</a></h3>
<ul>
<li><strong>筛选范围</strong>：尽量缩小筛选的依赖范围，避免对不相关的依赖进行不必要的版本检测，提升审计性能。</li>
<li><strong>规则模块化</strong>：将不同依赖的版本检测规则分模块编写，便于管理和优化。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-定期更新漏洞信息">4. 定期更新漏洞信息<a href="#4-定期更新漏洞信息" class="hash-link" aria-label="Direct link to 4. 定期更新漏洞信息" title="Direct link to 4. 定期更新漏洞信息">​</a></h3>
<ul>
<li><strong>漏洞数据库</strong>：及时更新已知漏洞的版本范围，确保 <strong>SyntaxFlow</strong> 规则能够覆盖最新的漏洞信息。</li>
<li><strong>自动化脚本</strong>：考虑使用自动化脚本定期更新和验证规则中的漏洞版本信息，保持规则的时效性。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="最佳实践">最佳实践<a href="#最佳实践" class="hash-link" aria-label="Direct link to 最佳实践" title="Direct link to 最佳实践">​</a></h2>
<p>为了充分发挥 <strong>SyntaxFlow</strong> 在依赖版本信息检测中的优势，建议遵循以下最佳实践：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-模块化编写规则">1. 模块化编写规则<a href="#1-模块化编写规则" class="hash-link" aria-label="Direct link to 1. 模块化编写规则" title="Direct link to 1. 模块化编写规则">​</a></h3>
<p>将不同依赖的版本检测规则分模块编写，每个模块专注于特定依赖的漏洞检测。例如，为 <code>fastjson</code>、<code>commons-io</code> 等常见依赖包分别编写独立的规则文件，提升规则的可维护性和可读性。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-结合自动化工具">2. 结合自动化工具<a href="#2-结合自动化工具" class="hash-link" aria-label="Direct link to 2. 结合自动化工具" title="Direct link to 2. 结合自动化工具">​</a></h3>
<p>利用自动化工具（如 CI/CD 管道）集成 <strong>SyntaxFlow</strong> 审计，确保每次代码提交或依赖更新时，自动触发版本信息检测，及时发现并处理潜在漏洞。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-定期审查和更新规则">3. 定期审查和更新规则<a href="#3-定期审查和更新规则" class="hash-link" aria-label="Direct link to 3. 定期审查和更新规则" title="Direct link to 3. 定期审查和更新规则">​</a></h3>
<p>随着项目依赖的变化和新漏洞的发现，定期审查并更新 <strong>SyntaxFlow</strong> 的规则，确保规则能够覆盖最新的依赖版本信息和漏洞范围。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-使用详细的描述和修复建议">4. 使用详细的描述和修复建议<a href="#4-使用详细的描述和修复建议" class="hash-link" aria-label="Direct link to 4. 使用详细的描述和修复建议" title="Direct link to 4. 使用详细的描述和修复建议">​</a></h3>
<p>在规则中提供详细的描述信息和明确的修复建议，帮助开发者快速理解问题并采取相应措施。例如，提示具体需要升级到的安全版本。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-测试规则的有效性">5. 测试规则的有效性<a href="#5-测试规则的有效性" class="hash-link" aria-label="Direct link to 5. 测试规则的有效性" title="Direct link to 5. 测试规则的有效性">​</a></h3>
<p>在大规模应用规则之前，先在小范围内测试，确保规则能够准确检测出目标依赖的漏洞版本，避免误报或漏报。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="Direct link to 总结" title="Direct link to 总结">​</a></h2>
<p>通过 <strong>SyntaxFlow</strong> 的依赖版本信息检测功能，开发者能够轻松识别项目中存在已知漏洞的依赖包版本，从而及时采取措施进行升级或替换，提升项目的安全性和稳定性。掌握 <code>version_in</code> 语法的使用方法，结合实际项目需求编写有效的规则，是确保代码安全的重要一环。遵循最佳实践，定期更新和优化规则，将显著提高依赖管理和漏洞检测的效率与准确性。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/yaklang/ssa.to/tree/main/syntaxflow-guide/syntaxflow-guide/statements/sf-sca.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-11-14T01:40:53.000Z" itemprop="dateModified">Nov 14, 2024</time></b> by <b>VillanCh</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/syntaxflow-guide/statements/sf-nativecall"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">原生扩展：重要的 NativeCall 机制</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#简介" class="table-of-contents__link toc-highlight">简介</a></li><li><a href="#获取依赖信息" class="table-of-contents__link toc-highlight">获取依赖信息</a></li><li><a href="#筛选依赖版本" class="table-of-contents__link toc-highlight">筛选依赖版本</a><ul><li><a href="#version_in-语法定义" class="table-of-contents__link toc-highlight">version_in 语法定义</a></li><li><a href="#version_in-语法示例" class="table-of-contents__link toc-highlight">version_in 语法示例</a></li></ul></li><li><a href="#实战案例分析具有漏洞版本的-fastjson" class="table-of-contents__link toc-highlight">实战案例：分析具有漏洞版本的 fastjson</a><ul><li><a href="#依赖信息示例maven" class="table-of-contents__link toc-highlight">依赖信息示例（Maven）</a></li><li><a href="#规则编写" class="table-of-contents__link toc-highlight">规则编写</a></li><li><a href="#执行效果" class="table-of-contents__link toc-highlight">执行效果</a></li></ul></li><li><a href="#实战中的注意事项" class="table-of-contents__link toc-highlight">实战中的注意事项</a><ul><li><a href="#1-确保依赖信息的准确性" class="table-of-contents__link toc-highlight">1. 确保依赖信息的准确性</a></li><li><a href="#2-版本区间的准确性" class="table-of-contents__link toc-highlight">2. 版本区间的准确性</a></li><li><a href="#3-性能优化" class="table-of-contents__link toc-highlight">3. 性能优化</a></li><li><a href="#4-定期更新漏洞信息" class="table-of-contents__link toc-highlight">4. 定期更新漏洞信息</a></li></ul></li><li><a href="#最佳实践" class="table-of-contents__link toc-highlight">最佳实践</a><ul><li><a href="#1-模块化编写规则" class="table-of-contents__link toc-highlight">1. 模块化编写规则</a></li><li><a href="#2-结合自动化工具" class="table-of-contents__link toc-highlight">2. 结合自动化工具</a></li><li><a href="#3-定期审查和更新规则" class="table-of-contents__link toc-highlight">3. 定期审查和更新规则</a></li><li><a href="#4-使用详细的描述和修复建议" class="table-of-contents__link toc-highlight">4. 使用详细的描述和修复建议</a></li><li><a href="#5-测试规则的有效性" class="table-of-contents__link toc-highlight">5. 测试规则的有效性</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer_jryj"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/en/docs/community#%E5%BE%AE%E4%BF%A1%E4%BA%A4%E6%B5%81%E7%BE%A4">Wechat</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"></div></div><div class="footer__copyright copyright_C_OK">Copyright © 2024 ssa.to, Powered by yaklang.io</div></footer></div>
</body>
</html>