<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-static-analysis-guide docs-version-current docs-doc-page docs-doc-id-deep-dive-into-ssa-oop" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">第五章：SSA 深水区 - OOP与无类 | SSA.to</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ssa.to/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ssa.to/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ssa.to/static-analysis-guide/deep-dive-into-ssa-oop"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-static-analysis-guide-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-static-analysis-guide-current"><meta data-rh="true" property="og:title" content="第五章：SSA 深水区 - OOP与无类 | SSA.to"><meta data-rh="true" name="description" content="闭包话题我们在前面进行了非常深入的讨论，在这一章，我们需要重点讨论 OOP 的 SSA 形态。"><meta data-rh="true" property="og:description" content="闭包话题我们在前面进行了非常深入的讨论，在这一章，我们需要重点讨论 OOP 的 SSA 形态。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ssa.to/static-analysis-guide/deep-dive-into-ssa-oop"><link data-rh="true" rel="alternate" href="https://ssa.to/static-analysis-guide/deep-dive-into-ssa-oop" hreflang="zh"><link data-rh="true" rel="alternate" href="https://ssa.to/en/static-analysis-guide/deep-dive-into-ssa-oop" hreflang="en"><link data-rh="true" rel="alternate" href="https://ssa.to/static-analysis-guide/deep-dive-into-ssa-oop" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.b1561eee.css">
<script src="/assets/js/runtime~main.ed521b05.js" defer="defer"></script>
<script src="/assets/js/main.1da0c771.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-dark.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SSA.to</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/static-analysis-guide/intro">静态代码分析教程</a><a class="navbar__item navbar__link" href="/docs/intro">代码扫描基础使用</a><a class="navbar__item navbar__link" href="/syntaxflow-guide/intro">SyntaxFlow 文档</a><a class="navbar__item navbar__link" href="/cookbook">SyntaxFlow 手册离线 PDF</a><a class="navbar__item navbar__link" href="/codeAnalysis">Code Analysis NOW!</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文</a><ul class="dropdown__menu"><li><a href="/static-analysis-guide/deep-dive-into-ssa-oop" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">中文</a></li><li><a href="/en/static-analysis-guide/deep-dive-into-ssa-oop" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><div class="navbarSearchContainer_dCNk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/intro">第一章：编译与静态代码分析概论</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/compile-ssa-form">第二章：详解静态单赋值形式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/ssa-for-advanced-language">第三章：高级语言的 SSA 构建（一）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/ssa-for-advanced-language-2">第三章：高级语言的 SSA 构建（二）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/deep-dive-into-ssa-closure">第四章：SSA 深水区 - 分析闭包函数</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/static-analysis-guide/deep-dive-into-ssa-oop">第五章：SSA 深水区 - OOP与无类</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/static-analysis-guide/deep-dive-into-ssa-dataflow-and-cross-procedure">第六章：SSA 数据流与跨过程分析</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">第五章：SSA 深水区 - OOP与无类</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>第五章：SSA 深水区 - OOP与无类</h1></header>
<p>闭包话题我们在前面进行了非常深入的讨论，在这一章，我们需要重点讨论 OOP 的 SSA 形态。</p>
<p>我们在无类（Classless）系统构建的时候，需要用到闭包来存储生成的对象，并且在案例中也会涉及到闭包核心功能，所以我们把 OOP 的 SSA 编译放在闭包讨论之后。</p>
<!-- -->
<div class="tableOfContentsInline_prmo"><ul class="table-of-contents"><li><a href="#无类系统">无类系统</a><ul><li><a href="#无类系统概念">无类系统概念</a></li><li><a href="#为什么-ssa-需要无类系统">为什么 SSA 需要无类系统</a></li></ul></li><li><a href="#原型委托与继承">原型委托与继承</a><ul><li><a href="#oop-中的继承是什么">OOP 中的继承是什么？</a></li><li><a href="#原型委托指的是什么">原型委托指的是什么？</a></li><li><a href="#用原型委托来实现继承">用原型委托来实现“继承”</a></li><li><a href="#对比继承和原型委托">对比“继承”和“原型委托”</a></li><li><a href="#流程对比">流程对比</a></li><li><a href="#形式化算法对比">形式化算法对比</a></li></ul></li><li><a href="#ssa-中的无类系统">SSA 中的无类系统</a><ul><li><a href="#应用ssa-无类系统编译-oop">应用：SSA 无类系统编译 OOP</a></li><li><a href="#oop-到原型委托的转换模型">OOP 到原型委托的转换模型</a></li><li><a href="#编译过程转换算法实现伪代码">编译过程转换算法实现（伪代码）</a></li></ul></li></ul></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="无类系统">无类系统<a href="#无类系统" class="hash-link" aria-label="无类系统的直接链接" title="无类系统的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="无类系统概念">无类系统概念<a href="#无类系统概念" class="hash-link" aria-label="无类系统概念的直接链接" title="无类系统概念的直接链接">​</a></h3>
<p>无类系统（Classless System）是一种不依赖传统类（Class）概念的对象系统，它通过组合原语操作（如闭包、委托、原型）来实现对象行为和状态管理。在这种系统中，对象是由一组属性和行为直接组合而成，而不是通过类的实例化来创建。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>核心特征</div><div class="admonitionContent_BuS1"><p>无类系统的核心在于：它将对象视为一个独立的实体，而不是某个类的实例。这种设计思想与 SSA 的理念高度契合，因为它们都致力于简化和明确化数据流动。</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>引用资料</div><div class="admonitionContent_BuS1"><p><strong>核心书籍</strong></p><ol>
<li><strong>《Prototype-based Programming: Concepts, Languages, and Applications》</strong> (1999)<!-- -->
<ul>
<li>作者：James Noble, Antero Taivalsaari, Ivan Moore</li>
<li>出版社：Springer</li>
<li>这是一本专门讨论原型编程的重要著作，详细介绍了无类系统的概念、语言实现和应用案例。</li>
</ul>
</li>
</ol><p><strong>重要论文和研究</strong></p><ol>
<li>
<p><strong>《Self: The Power of Simplicity》</strong> (1987)</p>
<ul>
<li>作者：David Ungar, Randall B. Smith</li>
<li>发表于：OOPSLA &#x27;87</li>
<li>这篇论文介绍了 Self 语言，这是最早的原型编程语言之一，对后续的无类系统研究产生了深远影响。</li>
</ul>
</li>
<li>
<p><strong>《Prototypes with Multiple Dispatch: An Expressive and Dynamic Object Model》</strong> (2005)</p>
<ul>
<li>作者：Craig Chambers</li>
<li>这篇论文探讨了在无类系统中使用多重分派的可能性。</li>
</ul>
</li>
</ol><p><strong>理论基础</strong></p><p>无类系统的理论基础主要建立在以下几个概念之上：</p><ol>
<li><strong>原型委托（Prototype Delegation）</strong>
可以用以下数学表达式来表示：</li>
</ol><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div><p>其中，</p><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 委托给 <div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div>，以此类推。<p></p><ol start="2">
<li><strong>对象组合（Object Composition）</strong>
表示为：</li>
</ol><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div><p>其中，</p><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 是属性，<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 是方法。<p></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="为什么-ssa-需要无类系统">为什么 SSA 需要无类系统<a href="#为什么-ssa-需要无类系统" class="hash-link" aria-label="为什么 SSA 需要无类系统的直接链接" title="为什么 SSA 需要无类系统的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>无类系统在 SSA 中的必要性</div><div class="admonitionContent_BuS1"><p>无类系统理论中的原型委托和组合这种概念本质上是行为和关系的描述，并不需要传统 OOP 那样需要引入新的概念来描述。</p><p>秉持“Less is More”的理念，使用无类系统表达类似传统 OOP 的程序行为在通用 SSA 编译中的还是很有必要讨论的。</p></div></div>
<p>本质上，我们并不是要完全不讨论传统基于类和对象的 OOP 系统，而是要探讨在不引入类和对象这个概念的前提下，如何等效表达传统 OOP 系统中的行为和关系。</p>
<p>为此，我们引入无类系统，并且使用无类中的原型委托和组合关系来表达 OOP 中的类似行为。这个操作的核心思路是 <strong>通过减少概念的数量来增加系统的可理解性和可优化性</strong>。</p>
<p>为了读者能更好的理解我们上述提出的观点。我们使用下面的案例来说明这么做的真正意义。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="案例无类系统表达-oop-行为">案例：无类系统表达 OOP 行为<a href="#案例无类系统表达-oop-行为" class="hash-link" aria-label="案例：无类系统表达 OOP 行为的直接链接" title="案例：无类系统表达 OOP 行为的直接链接">​</a></h4>
<p>我们使用一个语言（以 JavaScript 为例），他支持完整的闭包系统（见第四章），这门语言中包含一个“容器”，容器可以容纳任何值。</p>
<p>假定在 JavaScript 尤其是我们后续案例中，不包含任何 class 这个概念。</p>
<p>我们编写了如下一段代码：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">classContainer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;staticField&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token string-property property" style="color:#36acaa">&quot;staticMethod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;staticField&#x27;s value is &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sprint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">classContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">staticField</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-variable function" style="color:#d73a49">classConstructor</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;staticContainer&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">  classContainer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;field&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;defaultValue&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token string-property property" style="color:#36acaa">&quot;objectMethod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">field</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;objectMethod is called and staticMethod is called in objectMethod: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> classContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">staticMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">classConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">objectMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这段代码十分的精妙，我们发现，尽管我们在我们不使用 <code>class</code> 这个概念情况下，仍然可以表达出，一个类中的静态成员，对象的创建（闭包），对象的方法调用等一系列 OOP 特征。</p>
<p>我们可以看到三个核心组件：静态容器、对象工厂和实例对象。让我们通过一个更紧凑的方式来分析它们的关系和实现。上述代码解读如下：</p>
<!-- -->
<p>在上述代码中，包含一些重要的机制：</p>
<ol>
<li><strong>静态成员管理</strong></li>
</ol>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<ol start="2">
<li><strong>实例结构</strong></li>
</ol>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>设计要点</div><div class="admonitionContent_BuS1"><ul>
<li>静态容器(<code>classContainer</code>)作为单一共享实例，这个设计十分符合类中的静态成员的定义</li>
<li>实例对象通过直接引用静态容器实现静态成员访问</li>
<li>闭包确保了实例成员的独立性</li>
</ul></div></div>
<p>这种实现方式具有以下优势：</p>
<ol>
<li>状态共享更加显式（通过 <code>staticContainer</code> 引用）</li>
<li>对象结构更加清晰（实例成员与静态成员明确分离）</li>
<li>完全符合 SSA 的单一赋值原则</li>
</ol>
<p>我们构造的上面无类系统实现提供了传统 OOP 的核心特性，同时保持了代码的简洁性和数据流的清晰性。它展示了如何在不使用类的情况下，通过闭包和对象组合来实现对象系统的核心功能。</p>
<p>接下来我们深入解读一下上面代码中在无类概念中的一些细节：</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="原型委托与继承">原型委托与继承<a href="#原型委托与继承" class="hash-link" aria-label="原型委托与继承的直接链接" title="原型委托与  继承的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oop-中的继承是什么">OOP 中的继承是什么？<a href="#oop-中的继承是什么" class="hash-link" aria-label="OOP 中的继承是什么？的直接链接" title="OOP 中的继承是什么？的直接链接">​</a></h3>
<p>在传统的面向对象编程中，继承是一种代码重用和建立类型层次结构的机制。它允许一个类（子类）基于另一个类（父类）来定义，继承父类的属性和方法。</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>限定条件</div><div class="admonitionContent_BuS1"><p>注意，我们在这儿的讨论只认为父类只有一个。在某一些语言（C++）中，父类可以有多个。</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>继承的本质</div><div class="admonitionContent_BuS1"><p>继承本质上是一种代码复用机制，它建立了两个重要的关系：</p><ol>
<li><strong>结构复用</strong>：子类获得父类的属性和方法</li>
<li><strong>行为替换</strong>：子类可以重写（override）父类的方法</li>
</ol></div></div>
<p>让我们用数学语言来形式化地描述继承关系：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>其中：</p>
<ul>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示子类</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示父类</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示子类特有的成员</li>
</ul>
<p>在传统 OOP 中，这种关系通常通过类的继承机制来实现：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Parent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">parentMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;parent&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Child</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Parent</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">childMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;child&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述案例非常简单，接下来我们在深入讨论一些“多态”问题：</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>继承的两个核心特性</div><div class="admonitionContent_BuS1"><ol>
<li><strong>扩展性</strong>：子类可以添加新的属性和方法</li>
<li><strong>多态性</strong>：子类可以重新定义父类的方法行为</li>
</ol></div></div>
<p>让我们用更形式化的方式来描述这种关系：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>其中：</p>
<ul>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示子类的完整定义</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示父类的所有成员</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示被子类覆盖的父类成员集合</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示子类新增的成员集合</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示子类重写后的成员集合</li>
</ul>
<p>让我们通过一个具体的例子来说明：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Shape</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">color</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Drawing a shape&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">getColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">color</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Circle</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Shape</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">constructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">color</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> radius</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">color</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 调用父类构造器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">radius</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> radius</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 新增属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// 覆盖父类方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Drawing a circle&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">getArea</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// 新增方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token known-class-name class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PI</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">radius</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">radius</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在这个例子中：</p>
<ul>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> = <code>{radius, getArea}</code></li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> = <code>{draw}</code></li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> = <code>{新的draw实现}</code></li>
</ul>
<p>我们可以用类 UML 图来可视化这种关系：</p>
<!-- -->
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>继承的注意事项</div><div class="admonitionContent_BuS1"><ol>
<li>子类不能删除父类的成员，只能覆盖</li>
<li>子类方法在覆盖父类方法时，需要保持方法签名的一致性</li>
<li>构造函数通常需要显式调用父类的构造函数</li>
</ol></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="原型委托指的是什么">原型委托指的是什么？<a href="#原型委托指的是什么" class="hash-link" aria-label="原型委托指的是什么？的直接链接" title="原型委托指的是什么？的直接链接">​</a></h3>
<p>“原型委托”是我们在无类系统中需要使用到的一个概念。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>原型委托的定义</div><div class="admonitionContent_BuS1"><p>原型委托是一种对象行为共享的机制，它基于对象之间的委托关系，而不是类之间的继承关系。当一个对象无法响应某个请求时，该请求会被转发给该对象的原型。</p><div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>原型委托的核心思想</div><div class="admonitionContent_BuS1"><p>原型委托的核心是：当一个对象无法处理某个请求时，将该请求转发给它的原型对象。这种机制可以构建出一个委托链，实现类似继承的行为。</p></div></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="工作机制">工作机制<a href="#工作机制" class="hash-link" aria-label="工作机制的直接链接" title="工作机制的直接链接">​</a></h4>
<p>让我们用数学语言来形式化地描述原型委托：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>其中：</p>
<ul>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示属性访问的结果</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示当前对象</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示原型对象</li>
<li><div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:inline-block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container inline"></div></div> 表示要访问的属性</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="用原型委托来实现继承">用原型委托来实现“继承”<a href="#用原型委托来实现继承" class="hash-link" aria-label="用原型委托来实现“继承”的直接链接" title="用原型委托来实现“继承”的直接链接">​</a></h3>
<p>在无类系统中，我们可以通过原型委托（Prototype Delegation）来实现与传统继承相似的效果。这种方式更加灵活，且概念更加简单。</p>
<p>让我们看一个具体的实现：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 创建父对象工厂</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-variable function" style="color:#d73a49">parentConstructor</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;parentField&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;parent value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;parentMethod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;parent method: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">parentField</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 创建子对象工厂</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-variable function" style="color:#d73a49">childConstructor</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 创建父对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> parent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">parentConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 创建 子对象，并设置原型委托</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;childField&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;child value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string-property property" style="color:#36acaa">&quot;childMethod&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;child method: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">childField</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 设置委托关系</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Proxy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">child</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function-variable function" style="color:#d73a49">get</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> property</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> property </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> target </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   target</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">property</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                   parent</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">property</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 使用示例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> instance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">childConstructor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">childMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 访问子对象方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">instance</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">parentMethod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 通过委托访问父对象方法</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这种实现可以用以下图示来表示：</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="对比继承和原型委托">对比“继承”和“原型委托”<a href="#对比继承和原型委托" class="hash-link" aria-label="对比“继承”和“原型委托”的直接链接" title="对比“继承”和“原型委托”的直接链接">​</a></h3>
<!-- -->
<p>一般的语言中，如果要实现原型委托需要实现一个智能的 <code>lookup</code> 或者 <code>get</code> 函数，这个函数可以按照委托的算法来寻找真正的成员。在真实的过程中，这都是一个 “动态分派” 的过程。这个和传统 OOP 有很明显的区别。</p>
<p>虽然在 JVM 中，invokevirtual 也是动态分派，但是他是在 JVM 执行中按照具体类型到成员函数的静态表（在编译时确定）实现的，这个和原型委托的实现方式有很大区别 。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="jvm-中的-invokevirtual">JVM 中的 invokevirtual<a href="#jvm-中的-invokevirtual" class="hash-link" aria-label="JVM 中的 invokevirtual的直接链接" title="JVM 中的 invokevirtual的直接链接">​</a></h4>
<p>我们以一个案例来说明：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StaticDispatch {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static abstract class Human { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static class Man extends Human { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static class Woman extends Human { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    static class Child extends Human { }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void say(Human human) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;human&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void say(Man man) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;man&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void say(Woman woman) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;woman&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void say(Child child) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;child&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   public static void main(String[] args) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Human man = new Man();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Human woman = new Woman();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Human child = new Child();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      StaticDispatch dispatch = new StaticDispatch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dispatch.say(man);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dispatch.say(woman);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dispatch.say(child);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面代码非常好理解，执行 <code>javac</code> 和 <code>javap -v</code> 后我们可以发现：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Classfile /Users/v1ll4n/Projects/java/StaticDispatch.class</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Last modified 2024年12月11日; size 1092 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SHA-256 checksum 8bd647ebe2d81f43ac15977d9c16ddfc837031fb2438c45aaeb24cfeafcc8a1a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Compiled from &quot;StaticDispatch.java&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minor version: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  major version: 65</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  flags: (0x0021) ACC_PUBLIC, ACC_SUPER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  this_class: #36                         // StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  super_class: #2                         // java/lang/Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  interfaces: 0, fields: 0, methods: 6, attributes: 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Constant pool:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #1 = Methodref          #2.#3          // java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #2 = Class              #4             // java/lang/Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #3 = NameAndType        #5:#6          // &quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #4 = Utf8               java/lang/Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #5 = Utf8               &lt;init&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #6 = Utf8               ()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #7 = Fieldref           #8.#9          // java/lang/System.out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #8 = Class              #10            // java/lang/System</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   #9 = NameAndType        #11:#12        // out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #10 = Utf8               java/lang/System</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #11 = Utf8               out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #12 = Utf8               Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #13 = String             #14            // human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #14 = Utf8               human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #15 = Methodref          #16.#17        // java/io/PrintStream.println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #16 = Class              #18            // java/io/PrintStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #17 = NameAndType        #19:#20        // println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #18 = Utf8               java/io/PrintStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #19 = Utf8               println</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #20 = Utf8               (Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #21 = String             #22            // man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #22 = Utf8               man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #23 = String             #24            // woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #24 = Utf8               woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #25 = String             #26            // child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #26 = Utf8               child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #27 = Class              #28            // StaticDispatch$Man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #28 = Utf8               StaticDispatch$Man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #29 = Methodref          #27.#3         // StaticDispatch$Man.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #30 = Class              #31            // StaticDispatch$Woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #31 = Utf8               StaticDispatch$Woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #32 = Methodref          #30.#3         // StaticDispatch$Woman.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #33 = Class              #34            // StaticDispatch$Child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #34 = Utf8               StaticDispatch$Child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #35 = Methodref          #33.#3         // StaticDispatch$Child.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #36 = Class              #37            // StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #37 = Utf8               StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #38 = Methodref          #36.#3         // StaticDispatch.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #39 = Methodref          #36.#40        // StaticDispatch.say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #40 = NameAndType        #41:#42        // say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #41 = Utf8               say</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #42 = Utf8               (LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #43 = Utf8               Code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #44 = Utf8               LineNumberTable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #45 = Utf8               (LStaticDispatch$Man;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #46 = Utf8               (LStaticDispatch$Woman;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #47 = Utf8               (LStaticDispatch$Child;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #48 = Utf8               main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #49 = Utf8               ([Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #50 = Utf8               SourceFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #51 = Utf8               StaticDispatch.java</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #52 = Utf8               NestMembers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #53 = Class              #54            // StaticDispatch$Human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #54 = Utf8               StaticDispatch$Human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #55 = Utf8               InnerClasses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #56 = Utf8               Man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #57 = Utf8               Woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #58 = Utf8               Child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #59 = Utf8               Human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public StaticDispatch();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: ()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0001) ACC_PUBLIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=1, locals=1, args_size=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: aload_0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         4: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 1: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void say(StaticDispatch$Human);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: (LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0001) ACC_PUBLIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=2, locals=2, args_size=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         3: ldc           #13                 // String human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 9: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 10: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void say(StaticDispatch$Man);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: (LStaticDispatch$Man;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0001) ACC_PUBLIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=2, locals=2, args_size=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         3: ldc           #21                 // String man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 13: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 14: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void say(StaticDispatch$Woman);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: (LStaticDispatch$Woman;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0001) ACC_PUBLIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=2, locals=2, args_size=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         3: ldc           #23                 // String woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 17: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 18: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void say(StaticDispatch$Child);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: (LStaticDispatch$Child;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0001) ACC_PUBLIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=2, locals=2, args_size=2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: getstatic     #7                  // Field java/lang/System.out:Ljava/io/PrintStream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         3: ldc           #25                 // String child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         5: invokevirtual #15                 // Method java/io/PrintStream.println:(Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 21: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 22: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static void main(java.lang.String[]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    descriptor: ([Ljava/lang/String;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    flags: (0x0009) ACC_PUBLIC, ACC_STATIC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Code:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      stack=2, locals=5, args_size=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0: new           #27                 // class StaticDispatch$Man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         3: dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         4: invokespecial #29                 // Method StaticDispatch$Man.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         7: astore_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         8: new           #30                 // class StaticDispatch$Woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        11: dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        12: invokespecial #32                 // Method StaticDispatch$Woman.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        15: astore_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        16: new           #33                 // class StaticDispatch$Child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        19: dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        20: invokespecial #35                 // Method StaticDispatch$Child.&quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        23: astore_3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        24: new           #36                 // class StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        27: dup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        28: invokespecial #38                 // Method &quot;&lt;init&gt;&quot;:()V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        31: astore        4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        33: aload         4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        35: aload_1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        36: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        39: aload         4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        41: aload_2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        42: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        45: aload         4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        47: aload_3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        48: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        51: return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      LineNumberTable:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 25: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 26: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 27: 16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 29: 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 30: 33</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 31: 39</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 32: 45</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        line 33: 51</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SourceFile: &quot;StaticDispatch.java&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NestMembers:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StaticDispatch$Child</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StaticDispatch$Woman</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StaticDispatch$Man</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  StaticDispatch$Human</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">InnerClasses:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static #56= #27 of #36;                 // Man=class StaticDispatch$Man of class StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static #57= #30 of #36;                 // Woman=class StaticDispatch$Woman of class StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static #58= #33 of #36;                 // Child=class StaticDispatch$Child of class StaticDispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  static abstract #59= #53 of #36;        // Human=class StaticDispatch$Human of class StaticDispatch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在上面的字节码中，我们可以看到几个关键点：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 编译时期已经确定了方法签名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">36: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">42: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">48: invokevirtual #39                 // Method say:(LStaticDispatch$Human;)V</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="静态分派编译期">静态分派（编译期）<a href="#静态分派编译期" class="hash-link" aria-label="静态分派（编译期）的直接链接" title="静态分派（编译期）的直接链接">​</a></h4>
<ol>
<li><strong>重载方法的选择</strong>：在编译期间，编译器根据<strong>静态类型</strong>选择方法签名</li>
<li><strong>方法表生成</strong>：编译器为每个类生成一个静态的方法表（vtable）</li>
<li><strong>符号引用解析</strong>：将方法调用解析为具体的方法表索引</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="动态分派运行时">动态分派（运行时）<a href="#动态分派运行时" class="hash-link" aria-label="动态分派（运行时）的直接链接" title="动态分派（运行时）的直接链接">​</a></h4>
<ol>
<li><strong>虚方法调用</strong>：<code>invokevirtual</code>指令在运行时：<!-- -->
<ul>
<li>找到对象的实际类型</li>
<li>在该类的方法表中查找对应方法</li>
<li>通过方法表索引直接调用目标方法</li>
</ul>
</li>
</ol>
<p>在动态分派通过类来找到目标方法，这个只有静态语言可以做到，动态语言中，我们只能通过对象来找到目标方法，这也是原型委派和传统 OOP 不同的一个重要区别。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="流程对比">流程对比<a href="#流程对比" class="hash-link" aria-label="流程对比的直接链接" title="流程对比的直接链接">​</a></h3>
<p>上述虽然已经讲的比较清楚了，但是我们看下面两个图就可以很容易找到区别：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="原型委派流程图">原型委派流程图<a href="#原型委派流程图" class="hash-link" aria-label="原型委派流程图的直接链接" title="原型委派流程图的直接链接">​</a></h4>
<!-- -->
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="传统-oop-对象成员调用分发流程">传统 OOP 对象成员调用分发流程<a href="#传统-oop-对象成员调用分发流程" class="hash-link" aria-label="传统 OOP 对象成员调用分发流程的直接链接" title="传统 OOP 对象成员调用分发流程的直接链接">​</a></h4>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="形式化算法对比">形式化算法对比<a href="#形式化算法对比" class="hash-link" aria-label="形式化算法对比的直接链接" title="形式化算法对比的直接链接">​</a></h3>
<p>让我们深入分析这两种不同的成员访问机制，并用形式化的方式来描述它们的算法。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="原型委派的形式化算法">原型委派的形式化算法<a href="#原型委派的形式化算法" class="hash-link" aria-label="原型委派的形式化算法的直接链接" title="原型委派的形式化算法的直接链接">​</a></h4>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>定义重申</div><div class="admonitionContent_BuS1"><p>虽然我们在前面已经有过定义，但是为了方便理解，我们再重申一遍：</p></div></div>
<p>首先，让我们定义原型委派的核心数据结构：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>原型委派的查找算法可以用以下递归函数表示：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>算法复杂度</div><div class="admonitionContent_BuS1"><ul>
<li>时间复杂度：O(d)，其中 d 是原型链的深度</li>
<li>空间复杂度：O(1)，不考虑递归调用栈</li>
</ul></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="传统-oop-的形式化算法">传统 OOP 的形式化算法<a href="#传统-oop-的形式化算法" class="hash-link" aria-label="传统 OOP 的形式化算法的直接链接" title="传统 OOP 的形式化算法的直接链接">​</a></h4>
<p>对于传统 OOP，我们首先定义类的方法表结构：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>方法查找算法可以表示为：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>算法复杂度</div><div class="admonitionContent_BuS1"><ul>
<li>时间复杂度：O(1)，因为方法表通常使用哈希表实现</li>
<li>空间复杂度：O(m)，其中 m 是类的方法总数</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ssa-中的无类系统">SSA 中的无类系统<a href="#ssa-中的无类系统" class="hash-link" aria-label="SSA 中的无类系统的直接链接" title="SSA 中的无类系统的直接链接">​</a></h2>
<p>在 SSA 中，我们需要确保每个变量只被赋值一次，并且数据流动路径清晰可见。原型委托模型在这方面具有天然优势：</p>
<!-- -->
<p>在 SSA 形式中，这种查找过程可以表示为：</p>
<div class="katex-wrapper" style="position:relative;padding:8px;border:1px solid transparent;border-radius:4px;display:block;transition:all 0.3s ease;box-shadow:none"><div class="katex-container block"></div></div>
<p>我们观察上述 SSA 格式，发现，每个查找步骤都可能产生新的 SSA 版本，数据流向清晰可追踪，便于进行数据流分析和优化。</p>
<p>具体抽象出的代码如下：</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 原型委托在 SSA 中的形式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">lookup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">obj</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 形式</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// 初始值</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> v1</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// 直接查找</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v2 </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 结果检查</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v3 </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">__proto__</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 获取原型</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> v4 </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> v4</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 原型查找</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="应用ssa-无类系 统编译-oop">应用：SSA 无类系统编译 OOP<a href="#应用ssa-无类系统编译-oop" class="hash-link" aria-label="应用：SSA 无类系统编译 OOP的直接链接" title="应用：SSA 无类系统编译 OOP的直接链接">​</a></h3>
<p>根据我们在“原型委托”实现“继承”章节展示的内容，我们可以把传统 OOP 代码转换为原型委托模式，然后再编译为 SSA 无类系统，这样就可以在不引入过多新的概念的情况下，实现通用 OOP 代码的编译和静态分析了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oop-到原型委托的转换模型">OOP 到原型委托的转换模型<a href="#oop-到原型委托的转换模型" class="hash-link" aria-label="OOP 到原型委托的转换模型的直接链接" title="OOP 到原型委托的转换模型的直接链接">​</a></h3>
<p>首先，让我们定义一个形式化的转换模型：</p>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="编译过程转换算法实现伪代码">编译过程转换算法实现（伪代码）<a href="#编译过程转换算法实现伪代码" class="hash-link" aria-label="编译过程转换算法实现（伪代码）的直接链接" title="编译过程转换算法实现（伪代码）的直接链接">​</a></h3>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 扩展的原型链设置算法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setPrototypeChain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">targetObject</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> parentClass</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options </span><span class="token parameter operator" style="color:#393A34">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本1：初始验证</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">validatePrototypeTarget</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">targetObject</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本2：父类原型获取</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getParentPrototype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentClass</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本3：创建新的原型对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">create</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">constructor</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> targetObject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">constructor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">writable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">configurable</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本4：属性合并</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mergeProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本5：方法继承处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v5 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">inheritMethods</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本6：优化处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v6 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">optimizePrototype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v6</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 属性合并函数</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mergeProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> source</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本1：获取所有属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getOwnPropertyDescriptors</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本2：过滤属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">filterProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本3：应用属性</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">defineProperties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 方法继承处理</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">inheritMethods</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">target</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> parentProto</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本1：获取父类方法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getOwnPropertyNames</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentProto</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">name</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> parentProto</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;function&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本2：方法复制</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> v1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">reduce</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">obj</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> method</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            obj</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> parentProto</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">method</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> obj</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 原型优化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">optimizePrototype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">proto</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> options</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本1：属性访问优化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">optimizePropertyAccess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">proto</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本2：方法调用优化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">optimizeMethodCalls</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SSA 版本3：内联缓存设置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> v3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setupInlineCaching</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">v2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> v3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>算法流程图：</p>
</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/yaklang/ssa.to/tree/main/static-analysis-guide/static-analysis-guide/deep-dive-into-ssa-oop.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>v1ll4n</b> <!-- -->于 <b><time datetime="2024-12-11T08:15:20.000Z" itemprop="dateModified">2024年12月11日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/static-analysis-guide/deep-dive-into-ssa-closure"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">第四章：SSA 深水区 - 分析闭包函数</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/static-analysis-guide/deep-dive-into-ssa-dataflow-and-cross-procedure"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">第六章：SSA 数据流与跨过程分析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#无类系统" class="table-of-contents__link toc-highlight">无类系统</a><ul><li><a href="#无类系统概念" class="table-of-contents__link toc-highlight">无类系统概念</a></li><li><a href="#为什么-ssa-需要无类系统" class="table-of-contents__link toc-highlight">为什么 SSA 需要无类系统</a></li></ul></li><li><a href="#原型委托与继承" class="table-of-contents__link toc-highlight">原型委托与继承</a><ul><li><a href="#oop-中的继承是什么" class="table-of-contents__link toc-highlight">OOP 中的继承是什么？</a></li><li><a href="#原型委托指的是什么" class="table-of-contents__link toc-highlight">原型委托指的是什么？</a></li><li><a href="#用原型委托来实现继承" class="table-of-contents__link toc-highlight">用原型委托来实现“继承”</a></li><li><a href="#对比继承和原型委托" class="table-of-contents__link toc-highlight">对比“继承”和“原型委托”</a></li><li><a href="#流程对比" class="table-of-contents__link toc-highlight">流程对比</a></li><li><a href="#形式化算法对比" class="table-of-contents__link toc-highlight">形式化算法对比</a></li></ul></li><li><a href="#ssa-中的无类系统" class="table-of-contents__link toc-highlight">SSA 中的无类系统</a><ul><li><a href="#应用ssa-无类系统编译-oop" class="table-of-contents__link toc-highlight">应用：SSA 无类系统编译 OOP</a></li><li><a href="#oop-到原型委托的转换模型" class="table-of-contents__link toc-highlight">OOP 到原型委托的转换模型</a></li><li><a href="#编译过程转换算法实现伪代码" class="table-of-contents__link toc-highlight">编译过程转换算法实现（伪代码）</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer_jryj"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/community#%E5%BE%AE%E4%BF%A1%E4%BA%A4%E6%B5%81%E7%BE%A4">Wechat</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/yaklang/ssa.to" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"></div></div><div class="footer__copyright copyright_C_OK">Copyright © 2024 ssa.to, Powered by yaklang.io</div></footer></div>
</body>
</html>